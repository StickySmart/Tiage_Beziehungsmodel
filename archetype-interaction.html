<!--
 * ¬© 2025 Ti-age.de Alle Rechte vorbehalten.
 * Dieses Werk ist urheberrechtlich gesch√ºtzt.
 * Jegliche Nutzung ohne ausdr√ºckliche Genehmigung ist untersagt.
 -->
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Das anarchische Ti-Age Prinzip der Paarung | Swipe</title>
    <link rel="canonical" href="https://ti-age.de/archetype-interaction.html">
    <!-- Zentrale CSS-Variablen - EINZIGE QUELLE -->
    <link rel="stylesheet" href="templates/variables.css?v=20251205c">
    <link rel="stylesheet" href="templates/template_desktop.css?v=20251205c">
    <link rel="stylesheet" href="templates/template_mobile.css?v=20251205c" media="(max-width: 768px)">
    <!-- Hilfe-Styling - PERMANENTE SICHERUNG (nicht ver√§ndern!) -->
    <link rel="stylesheet" href="css/help.css">
    <!-- Memory Manager Styling -->
    <link rel="stylesheet" href="css/memory-manager.css">
    <!-- Philosophy Hint Styling -->
    <link rel="stylesheet" href="css/philosophy-hint.css">
    <!-- Resonanz Tree View Styling -->
    <link rel="stylesheet" href="css/resonanz-tree-view.css">
    <!-- Slot Machine Modal Styling -->
    <link rel="stylesheet" href="css/slot-machine.css">

    <!-- Resource Hints f√ºr bessere Performance -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://script.google.com">

    <!-- Preload entfernt - verursachte Browser-Warnings weil Ressourcen
         nicht sofort nach dem Load-Event verwendet wurden.
         variables.css wird bereits als Stylesheet geladen (Zeile 14).
         JS-Dateien werden sp√§ter via script-Tags geladen. -->

    <!-- Critical Loading Indicator Styles (inline f√ºr sofortige Anzeige) -->
    <style id="critical-loading-styles">
        .app-loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 99999;
            transition: opacity 0.3s ease-out;
        }
        .app-loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .app-loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(168, 85, 247, 0.2);
            border-top-color: #A855F7;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        .app-loading-text {
            color: #A855F7;
            margin-top: 16px;
            font-family: system-ui, -apple-system, sans-serif;
            font-size: 14px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Mobile Blocker - Work in Progress */
        .mobile-wip-blocker {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            z-index: 999999;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .mobile-wip-blocker h1 {
            color: #A855F7;
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 3px;
        }
        .mobile-wip-blocker p {
            color: #ffffff;
            font-size: 1.5rem;
            font-weight: bold;
            line-height: 1.6;
        }
        .mobile-wip-blocker .emoji {
            font-size: 4rem;
            margin-bottom: 30px;
        }
        @media (max-width: 768px) {
            .mobile-wip-blocker {
                display: flex !important;
            }
            .mobile-multipage,
            .main-container,
            .app-loading-overlay {
                display: none !important;
            }
        }
    </style>

    <!-- LocalForage - Browser-Datenbank f√ºr Profile -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>

    <!-- TIAGE i18n - Lazy Language Loading (spart ~70KB) -->
    <script src="js/locales/loader.js"></script>

    <!-- TIAGE Core Modules (Phase 2+3 Refactoring) -->
    <script src="js/core/tooltips.js?v=20260128"></script>
    <script src="js/core/archetypeDescriptions.js?v=20260128"></script>
    <script src="js/core/tagTooltips.js?v=20260128"></script>
    <script src="js/core/statementHelpers.js?v=20260128"></script>
    <script src="js/utils/fuzzySearch.js?v=20260128"></script>
    <script src="js/ui/chartUtils.js?v=20260128"></script>
    <script src="js/ui/collapsible.js?v=20260205"></script>
    <script src="js/core/eventBus.js?v=20260130"></script>
    <script src="js/core/actionHandler.js?v=20260130"></script>
    <script defer src="js/core/actions/commentModal.js?v=20260130"></script>
    <script defer src="js/core/actions/definitionModal.js?v=20260130"></script>
    <script defer src="js/core/actions/factorModal.js?v=20260130"></script>
    <script defer src="js/core/actions/syntheseModal.js?v=20260130"></script>
    <script defer src="js/core/actions/explanationModals.js?v=20260130"></script>
    <script defer src="js/core/actions/listModals.js?v=20260130"></script>
    <script defer src="js/core/actions/dimensionInfoModals.js?v=20260130"></script>
    <script defer src="js/core/actions/archetypeGrid.js?v=20260130"></script>
    <script defer src="js/core/actions/slotMachine.js?v=20260130"></script>
    <script defer src="js/core/actions/headerControls.js?v=20260130"></script>
    <script defer src="js/core/actions/statusToggles.js?v=20260130"></script>
    <script defer src="js/core/actions/navigationActions.js?v=20260130"></script>
    <script defer src="js/core/actions/modalActions.js?v=20260130"></script>
    <script defer src="js/core/actions/secondaryActions.js?v=20260130"></script>
    <script defer src="js/core/actions/rtiPillarActions.js?v=20260205"></script>
    <script>
        // Lade nur die ben√∂tigte Sprache (lazy-loading)
        (function() {
            var lang = TiageLocaleLoader.detectLanguage();
            var script = document.createElement('script');
            script.src = 'js/locales/' + lang + '.js';
            script.onload = function() {
                console.log('[LazyLang] Initiale Sprache geladen: ' + lang);
            };
            document.head.appendChild(script);
        })();
    </script>
    <script defer src="js/i18n.js"></script>
    <script defer src="js/utils/tts.js"></script>
    <script defer src="js/version.js"></script>

    <!-- TIAGE Micro-Statements Databases -->
    <script defer src="statements/archetypeStatements.js"></script>
    <script defer src="statements/archetypeStatements_EN.js"></script>
    <script defer src="statements/dominanceStatements.js"></script>
    <script defer src="statements/orientationStatements.js"></script>
    <script defer src="statements/statusStatements.js"></script>
    <script defer src="statements/gfkStatements.js"></script>
    <script defer src="statements/resonanceQuotesTable.js"></script>

    <!-- TIAGE SYNTHESE - Zentralisierte Berechnungslogik -->
    <script defer src="js/synthesis/constants.js?v=20260130"></script>
    <script defer src="js/help-texts.js?v=20260130"></script>
    <script defer src="js/synthesis/needsIntegration.js?v=20260130"></script>
    <script defer src="js/synthesis/factors/archetypeMatrixCalculator.js?v=20260130"></script>
    <script defer src="js/synthesis/factors/archetypeFactor.js?v=20260130"></script>
    <script defer src="js/synthesis/factors/dominanceFactor.js?v=20260130"></script>
    <script defer src="js/synthesis/factors/orientationFactor.js?v=20260130"></script>
    <script defer src="js/synthesis/factors/genderFactor.js?v=20260130"></script>
    <script defer src="js/synthesis/lifestyleFilter.js?v=20260130"></script>
    <script defer src="js/utils/statistics.js?v=20260130"></script>
    <script defer src="js/utils/hauptfrageAggregation.js?v=20260130"></script>
    <!-- Performance Utilities f√ºr UI-Freeze-Pr√§vention -->
    <script defer src="js/utils/performance.js?v=20260130"></script>
    <script defer src="js/synthesis/synthesisCalculator.js?v=20260130"></script>
    <script defer src="js/synthesis/pathosTextGenerator.js"></script>
    <script defer src="js/synthesis/logosTextGenerator.js"></script>
    <script defer src="js/synthesis/oshoZenTextGenerator.js"></script>
    <script defer src="js/synthesis/integratedSynthesisTextGenerator.js"></script>

    <!-- SSOT VERGLEICHS-LOGGING (aktivieren mit ?ssot=true) -->
    <script defer src="js/ssot-comparison.js"></script>

    <!-- TIAGE COMPATIBILITY - Extrahierte Kompatibilit√§tslogik -->
    <script defer src="js/compatibility/physicalCompatibility.js"></script>
    <script defer src="js/compatibility/philosophyCompatibility.js"></script>
    <script defer src="js/compatibility/compatibilityOrchestrator.js"></script>

    <!-- TIAGE DIMENSIONS - Extrahierte Dimensions-Modifikatoren -->
    <script defer src="js/dimensions/tagDimensionRelevance.js"></script>
    <script defer src="js/dimensions/dominanzModifier.js"></script>
    <script defer src="js/dimensions/tagCalculator.js"></script>
    <!-- BED√úRFNIS-KATALOG (SSOT - l√§dt JSON direkt, MUSS vor Archetypen) -->
    <script defer src="profiles/definitions/beduerfnis-katalog.js"></script>
    <!-- ARCHETYP PROFILE (88 Bed√ºrfnisse pro Profil) -->
    <script defer src="profiles/archetypen/single.js"></script>
    <script defer src="profiles/archetypen/duo.js"></script>
    <script defer src="profiles/archetypen/duo-flex.js"></script>
    <script defer src="profiles/archetypen/solopoly.js"></script>
    <script defer src="profiles/archetypen/polyamor.js"></script>
    <script defer src="profiles/archetypen/ra.js"></script>
    <script defer src="profiles/archetypen/lat.js"></script>
    <script defer src="profiles/archetypen/aromantisch.js"></script>
    <script defer src="profiles/archetypen/index.js"></script>
    <!-- GESCHLECHTSIDENTIT√ÑT MODIFIER (v4.0: 3 Typen mit Legacy-Aliases) -->
    <script defer src="profiles/modifiers/gender/mann.js"></script>
    <script defer src="profiles/modifiers/gender/frau.js"></script>
    <script defer src="profiles/modifiers/gender/nonbinaer.js"></script>
    <!-- DOMINANZ MODIFIER (4 Typen) -->
    <script defer src="profiles/modifiers/dominanz/dominant.js"></script>
    <script defer src="profiles/modifiers/dominanz/submissiv.js"></script>
    <script defer src="profiles/modifiers/dominanz/switch.js"></script>
    <script defer src="profiles/modifiers/dominanz/ausgeglichen.js"></script>
    <!-- ORIENTIERUNG MODIFIER (v4.1: 5 Typen) -->
    <script defer src="profiles/modifiers/orientierung/heterosexuell.js"></script>
    <script defer src="profiles/modifiers/orientierung/homosexuell.js"></script>
    <script defer src="profiles/modifiers/orientierung/bisexuell.js"></script>
    <script defer src="profiles/modifiers/orientierung/pansexuell.js"></script>
    <script defer src="profiles/modifiers/orientierung/queer.js"></script>
    <!-- FFH MODIFIER (v4.2: Fit, Fucked up, Horny) -->
    <script defer src="profiles/modifiers/ffh/fit.js"></script>
    <script defer src="profiles/modifiers/ffh/fuckedup.js"></script>
    <script defer src="profiles/modifiers/ffh/horny.js"></script>
    <!-- RTI-S√ÑULEN MODIFIER (Petzold 5 S√§ulen) -->
    <script defer src="profiles/modifiers/rti/rti-modifier.js"></script>
    <!-- MODIFIER INDEX (l√§dt alle) -->
    <script defer src="profiles/modifiers/index.js"></script>
    <!-- SSOT Taxonomie (MUSS vor anderen Definitionen geladen werden) -->
    <script defer src="profiles/definitions/taxonomie.js"></script>
    <!-- GFK Bed√ºrfnisse & Modifikatoren -->
    <script defer src="profiles/definitions/tiage-beduerfnisse.js"></script>
    <script defer src="profiles/beduerfnis-modifikatoren.js"></script>
    <script defer src="profiles/definitions/archetyp-definitions.js"></script>
    <script defer src="profiles/profile-store.js"></script>
</head>
<body>
    <!-- Mobile Work-in-Progress Blocker -->
    <div class="mobile-wip-blocker">
        <div class="emoji">üöß</div>
        <h1>In Arbeit</h1>
        <p>BITTE NUTZEN SIE<br>EINEN COMPUTER</p>
    </div>

    <!-- Loading Overlay - sofort sichtbar w√§hrend JS l√§dt -->
    <div id="appLoadingOverlay" class="app-loading-overlay">
        <div class="app-loading-spinner"></div>
        <div class="app-loading-text">Ti-Age l√§dt...</div>
    </div>

    <!-- Age Verification - Inline Script BEFORE modal for onclick to work -->
    <script>
        // =====
        // GOOGLE SHEETS CONFIGURATION
        // =====
        // Nach dem Deployen des Google Apps Scripts, f√ºge hier die URL ein:
        // const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/DEINE_SCRIPT_ID/exec';
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzuHUlgKBXl_HCoTdddpYo97qo3sTf26ahkC-h04EPzKJJV-7bT3-h3qBkiXm30qk1HRg/exec';

        // Define confirmAge immediately so onclick handlers work
        // Modal appears once per session (uses sessionStorage)
        window.confirmAge = function(isAdult) {
            console.log('confirmAge called:', isAdult);
            try {
                var modal = document.getElementById('ageVerificationModal');

                if (isAdult) {
                    // Save age verification for this session (prevents showing on back navigation)
                    try {
                        sessionStorage.setItem('tiage_age_verified', 'true');
                    } catch(e) {
                        console.warn('Could not save session age verification:', e);
                    }

                    // Automatically save cookie consent when user confirms age
                    try {
                        localStorage.setItem('tiage_cookie_consent', 'true');
                        localStorage.setItem('tiage_cookie_consent_timestamp', new Date().toISOString());
                    } catch(e) {
                        console.warn('Could not save cookie consent:', e);
                    }

                    // Hide the modal for this session
                    if (modal) {
                        modal.classList.add('hidden');
                        modal.style.display = 'none';
                        modal.style.visibility = 'hidden';
                        modal.style.opacity = '0';
                        modal.style.pointerEvents = 'none';
                    }
                    document.body.style.overflow = 'auto';
                } else {
                    window.location.href = 'https://www.google.com';
                }
            } catch(e) {
                console.error('confirmAge error:', e);
                var m = document.getElementById('ageVerificationModal');
                if (m) m.style.display = 'none';
            }
        };
    </script>

    <!-- GFK Explanation Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="gfk-modal-overlay" id="gfkExplanationModal" data-action="close-gfk-modal">
        <div class="gfk-modal" data-stop-propagation>
            <div class="gfk-modal-header">
                <div class="gfk-modal-title">
                    <span>GFK-Kompetenz</span>
                    <span id="gfkModalLevelBadge" class="gfk-level-indicator"></span>
                </div>
                <button class="gfk-modal-close" data-action="close-gfk-modal">&times;</button>
            </div>
            <div class="gfk-modal-content">
                <div class="gfk-explanation-text" id="gfkModalExplanation">
                </div>
                <div class="gfk-info-box">
                    <div class="gfk-info-box-title">Automatische Berechnung</div>
                    <div class="gfk-info-box-text">
                        Die GFK-Kompetenz wird automatisch basierend auf den gew√§hlten Beziehungsarchetypen berechnet.
                        Sie zeigt die √úbereinstimmung der Kernbed√ºrfnisse nach Marshall Rosenbergs Gewaltfreier Kommunikation.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bed√ºrfnis-Vergleich Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="needsCompareModal" data-action="close-needs-compare-modal" style="z-index: 2200;">
        <div class="modal" data-stop-propagation style="max-width: 500px;">
            <div class="modal-header">
                <span class="modal-title" id="needsCompareModalTitle">Bed√ºrfnis-Vergleich</span>
                <button class="modal-close" data-action="close-needs-compare-modal">&times;</button>
            </div>
            <div class="modal-body" id="needsCompareModalBody" style="padding: 20px;">
                <!-- Content wird dynamisch gef√ºllt -->
            </div>
        </div>
    </div>

    <!-- Bed√ºrfnis-Definition Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="needDefinitionModal" data-action="close-need-definition-modal" style="z-index: 2500;">
        <div class="modal" data-stop-propagation style="max-width: 420px;">
            <div class="modal-header">
                <span class="modal-title" id="needDefinitionModalTitle">Definition</span>
                <button class="modal-close" data-action="close-need-definition-modal">&times;</button>
            </div>
            <div class="modal-body" id="needDefinitionModalBody" style="padding: 20px;">
                <!-- Content wird dynamisch gef√ºllt -->
            </div>
        </div>
    </div>

    <!-- Bed√ºrfnis-Score Erkl√§rung Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="needsScoreExplanationModal" data-action="close-needs-score-explanation" style="z-index: 2600;">
        <div class="modal" data-stop-propagation style="max-width: 600px; max-height: 85vh; overflow-y: auto;">
            <div class="modal-header" style="border-bottom: 2px solid rgba(34,197,94,0.3);">
                <span class="modal-title" style="color: #22c55e;">Bed√ºrfnis-√úbereinstimmung - Berechnung</span>
                <button class="modal-close" data-action="close-needs-score-explanation">&times;</button>
            </div>
            <div class="modal-body" id="needsScoreExplanationBody" style="padding: 20px;">
                <!-- Content wird dynamisch gef√ºllt -->
            </div>
        </div>
    </div>

    <!-- GFK Begriffserkl√§rung Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="gfkExplanationModal" data-action="close-gfk-modal" style="z-index: 2400;">
        <div class="modal" data-stop-propagation style="max-width: 400px;">
            <div class="modal-header" style="border-bottom: 2px solid rgba(139,92,246,0.3);">
                <span class="modal-title" style="color: #8B5CF6;">Gewaltfreie Kommunikation (GFK)</span>
                <button class="modal-close" data-action="close-gfk-modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <p style="font-size: 14px; line-height: 1.7; color: var(--text-primary); margin: 0 0 16px 0;">
                    Nach <strong>Marshall Rosenberg</strong> sind Bed√ºrfnisse universell und frei von Bewertung. Sie beschreiben, was wir zum Leben brauchen.
                </p>
                <p style="font-size: 13px; line-height: 1.6; color: var(--text-secondary); margin: 0;">
                    Die GFK unterscheidet klar zwischen Bed√ºrfnissen (was wir brauchen) und Strategien (wie wir es erf√ºllen). Diese Unterscheidung hilft uns, authentisch zu kommunizieren und echte Verbindung zu schaffen.
                </p>
            </div>
        </div>
    </div>

    <!-- Paarung Begriffserkl√§rung Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="paarungExplanationModal" data-action="close-paarung-modal" style="z-index: 2500;">
        <div class="modal" data-stop-propagation style="max-width: 400px;">
            <div class="modal-header" style="border-bottom: 2px solid rgba(232,67,147,0.3);">
                <span class="modal-title" style="color: #E84393;">Paarung</span>
                <button class="modal-close" data-action="close-paarung-modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <p style="font-size: 14px; line-height: 1.7; color: var(--text-primary); margin: 0 0 16px 0;">
                    In Beziehungen ist das gegenseitige Verstehen von Bed√ºrfnissen essenziell. Wenn beide Partner ihre Bed√ºrfnisse kennen und kommunizieren, entsteht Raum f√ºr echte Verbindung und gemeinsames Wachstum.
                </p>
                <p style="font-size: 13px; line-height: 1.6; color: var(--text-secondary); margin: 0;">
                    Die Paarung zeigt, wie gut die Bed√ºrfnisse beider Partner zueinander passen und wo Potenzial f√ºr gegenseitige Erf√ºllung besteht.
                </p>
            </div>
        </div>
    </div>

    <!-- Attribut-Definition Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="attributeDefinitionModal" data-action="close-attribute-definition-modal" style="z-index: 2400;">
        <div class="modal" data-stop-propagation style="max-width: 420px;">
            <div class="modal-header">
                <span class="modal-title" id="attributeDefinitionModalTitle">Definition</span>
                <button class="modal-close" data-action="close-attribute-definition-modal">&times;</button>
            </div>
            <div class="modal-body" id="attributeDefinitionModalBody" style="padding: 20px;">
                <!-- Content wird dynamisch gef√ºllt -->
            </div>
        </div>
    </div>

    <!-- RTI-S√§ulen Definition Modal (h√∂herer z-index als slotMachineModal!) -->
    <div class="modal-overlay" id="rtiPillarModal" data-action="close-rti-pillar-modal" style="z-index: 2800;">
        <div class="modal" data-stop-propagation style="max-width: 450px;">
            <div class="modal-header" style="border-bottom: 2px solid var(--rti-color, #F4A261);">
                <span class="modal-title" id="rtiPillarModalTitle" style="color: var(--rti-color, #F4A261);">RTI-S√§ule</span>
                <button class="modal-close" data-action="close-rti-pillar-modal">&times;</button>
            </div>
            <div class="modal-body" id="rtiPillarModalBody" style="padding: 20px;">
                <!-- Content wird dynamisch gef√ºllt -->
            </div>
        </div>
    </div>

    <!-- Resonanzfaktor-Hilfe Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="resonanzHelpModal" data-action="close-resonanz-help-modal" style="z-index: 2450;">
        <div class="modal" data-stop-propagation style="max-width: 700px; max-height: 85vh; overflow-y: auto;">
            <div class="modal-header" style="border-bottom: 2px solid rgba(139,92,246,0.3);">
                <span class="modal-title" style="color: #8B5CF6;" id="resonanzHelpModalTitle">Resonanzfaktoren - Berechnung</span>
                <button class="modal-close" data-action="close-resonanz-help-modal">&times;</button>
            </div>
            <div class="modal-body" id="resonanzHelpModalBody" style="padding: 20px;">
                <!-- Content wird dynamisch gef√ºllt -->
            </div>
        </div>
    </div>

    <!-- Comment Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="comment-modal-overlay" id="commentModal" data-action="close-comment-modal">
        <div class="comment-modal" data-stop-propagation>
            <div class="comment-modal-header">
                <h3>Kommentar senden</h3>
                <button class="comment-modal-close" data-action="close-comment-modal">&times;</button>
            </div>
            <div class="comment-modal-body">
                <div class="comment-form-group">
                    <label for="commentName">Besucher-Nr</label>
                    <input type="text" id="commentName" readonly style="background-color: rgba(255,255,255,0.1); cursor: not-allowed;">
                </div>
                <div class="comment-form-group">
                    <label for="commentText">Was denkst Du?</label>
                    <textarea id="commentText" placeholder="Schreibe hier deine Gedanken..." maxlength="2000" required></textarea>
                    <small class="input-hint">Max. 2000 Zeichen</small>
                </div>
                <button class="comment-submit-btn" id="commentSubmitBtn" data-action="submit-comment">Absenden</button>
            </div>
        </div>
    </div>

    <!-- Profile Review Info Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="profileReviewInfoModal" data-action="close-profile-review-info-modal" style="z-index: 2400;">
        <div class="modal" data-stop-propagation style="max-width: 420px;">
            <div class="modal-header" style="background: var(--primary); color: white;">
                <span class="modal-title" id="profileReviewInfoTitle">‚ÑπÔ∏è Information</span>
                <button class="modal-close" data-action="close-profile-review-info-modal" style="color: white;">&times;</button>
            </div>
            <div class="modal-body" style="padding: 24px; max-height: 60vh; overflow-y: auto;">

                <!-- Statistik -->
                <div class="profile-review-info-section">
                    <div class="profile-review-info-section-title">
                        <span>üìä</span>
                        <span>STATISTIK</span>
                    </div>
                    <div class="profile-review-info-section-content" id="profileReviewInfoStats"></div>
                </div>

                <!-- Forschung -->
                <div class="profile-review-info-section">
                    <div class="profile-review-info-section-title">
                        <span>üî¨</span>
                        <span>FORSCHUNG</span>
                    </div>
                    <div class="profile-review-info-section-content" id="profileReviewInfoResearch"></div>
                </div>

                <!-- Pirsig -->
                <div class="profile-review-info-section">
                    <div class="profile-review-info-section-title">
                        <span>üí≠</span>
                        <span>PIRSIG</span>
                    </div>
                    <div class="profile-review-info-section-content" id="profileReviewInfoPirsig"></div>
                </div>

                <!-- Osho -->
                <div class="profile-review-info-section">
                    <div class="profile-review-info-section-title">
                        <span>üßò</span>
                        <span>OSHO</span>
                    </div>
                    <div class="profile-review-info-section-content" id="profileReviewInfoOsho"></div>
                </div>

            </div>
            <div class="modal-footer" style="padding: 16px 20px; border-top: 1px solid var(--border);">
                <button class="btn-primary" data-action="close-profile-review-info-modal" style="width: 100%; padding: 14px; border-radius: 8px; font-size: 15px; font-weight: 600;">
                    Verstanden
                </button>
            </div>
        </div>
    </div>

    <!-- Comments List Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="comments-list-overlay" id="commentsListModal" data-action="close-comments-list-modal">
        <div class="comments-list-modal" data-stop-propagation>
            <div class="comments-list-header">
                <h2>üìã Alle Kommentare</h2>
                <button class="help-modal-close" data-action="close-comments-list-modal">&times;</button>
            </div>
            <div class="comments-actions-bar">
                <button class="new-comment-btn" data-action="open-comment-modal" data-close-list="true">
                    ‚úèÔ∏è Neuen Kommentar schreiben
                </button>
            </div>
            <div class="comments-search-container">
                <div class="comments-search-wrapper">
                    <span class="comments-search-icon">üîç</span>
                    <input type="text"
                           id="commentsSearchInput"
                           class="comments-search-input"
                           placeholder="Suche... (* als Platzhalter)"
                           oninput="filterComments(this.value)">
                    <button class="comments-search-clear" id="commentsSearchClear" data-action="clear-comments-search">&times;</button>
                </div>
                <div class="comments-search-hint">Beispiel: *fehler* findet alle Kommentare mit "fehler" im Text</div>
            </div>
            <div class="comments-search-results" id="commentsSearchResults" style="display: none;"></div>
            <div class="comments-list-body" id="commentsListBody">
                <div class="no-comments">
                    <div class="no-comments-icon">üí¨</div>
                    <p>Lade Kommentare...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Age Verification Modal -->
    <div class="age-verification-overlay" id="ageVerificationModal">
        <div class="age-verification-modal" data-stop-propagation>
            <!-- Language Toggle in Age Check -->
            <div class="age-verification-lang" style="position: absolute; top: 15px; right: 15px;">
                <button class="lang-btn" data-action="toggle-language-full" title="Switch Language / Sprache wechseln">
                    <span class="lang-icon">üåê</span>
                    <span class="lang-code" id="ageVerifyLangCode">DE</span>
                </button>
            </div>
            <div class="age-verification-icon">üîû</div>
            <h2 data-i18n="ageVerification.title">Altersverifikation</h2>
            <p data-i18n="ageVerification.description">Diese Seite enth√§lt Inhalte √ºber Beziehungsmodelle und ist nur f√ºr Personen ab 18 Jahren bestimmt.</p>
            <!-- Terms BEFORE buttons for GDPR/TTDSG compliance - users must see terms before clicking -->
            <p class="age-verification-note" style="margin-top: 0; margin-bottom: 15px;" id="ageVerificationTerms">
                Mit dem Klick auf "Ja" best√§tigst du, dass du:<br>
                ‚Ä¢ vollj√§hrig bist (mindestens 18 Jahre alt)<br>
                ‚Ä¢ die <a href="nutzungsbedingungen.html" target="_blank" style="color: #4A90E2; text-decoration: underline;">Nutzungsbedingungen</a> und <a href="datenschutz.html" target="_blank" style="color: #4A90E2; text-decoration: underline;">Datenschutzerkl√§rung</a> akzeptierst<br>
                ‚Ä¢ die Verwendung von Cookies und LocalStorage zur Speicherung deiner Eingaben und Pr√§ferenzen akzeptierst<br>
                ‚Ä¢ zur Kenntnis nimmst, dass alle Inhalte urheberrechtlich gesch√ºtzt sind<br>
                ‚Ä¢ die Inhalte nur f√ºr pers√∂nliche, nicht-kommerzielle Zwecke nutzt
            </p>
            <div class="age-verification-question">
                <strong data-i18n="ageVerification.question">Bist du mindestens 18 Jahre alt?</strong>
            </div>

            <!-- Buttons -->
            <div class="age-verification-buttons">
                <button class="age-btn age-btn-yes" id="ageVerifyYes" type="button" data-action="confirm-age" data-confirm="true" data-i18n="ageVerification.confirm">
                    Ja, ich bin 18+
                </button>
                <button class="age-btn age-btn-no" id="ageVerifyNo" type="button" data-action="confirm-age" data-confirm="false" data-i18n="ageVerification.deny">
                    Nein, ich bin unter 18
                </button>
            </div>
            <div class="age-verification-version" id="ageVerificationVersion" style="margin-top: 20px; font-size: 11px; color: rgba(255,255,255,0.4); line-height: 1.6;">
                <div id="ageVersionLine"></div>
                <div id="ageMergeLine"></div>
            </div>
        </div>
    </div>

    <!-- Bindungsmuster Tooltip (erscheint bei Klick f√ºr 2 Sekunden) -->
    <div class="bindung-tooltip" id="bindungTooltip">
        <span class="bindung-tooltip-icon" id="bindungTooltipIcon"></span>
        <div class="bindung-tooltip-title" id="bindungTooltipTitle"></div>
        <div class="bindung-tooltip-text" id="bindungTooltipText"></div>
    </div>

    <!-- Slot Machine Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="slotMachineModal" data-action="close-slot-machine-modal" style="z-index: 2700;">
        <div class="modal slot-machine-modal" data-stop-propagation style="max-width: 500px; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);">
            <div class="modal-header" style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                <span class="modal-title">Wie tickst Du?</span>
                <button class="modal-close" data-action="close-slot-machine-modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <!-- Phase 1: Bindungsmuster Auswahl -->
                <div id="slotPhase1" class="slot-phase">
                    <h3 style="color: #e94560; margin-bottom: 15px; text-align: center;">W√§hle was zu dir passt</h3>
                    <p style="color: rgba(255,255,255,0.7); font-size: 13px; text-align: center; margin-bottom: 20px;">
                        Nach Bowlby/Ainsworth - wird als Tie-Breaker bei gleichem Score verwendet
                    </p>

                    <div class="bindung-selection">
                        <div class="bindung-group">
                            <label style="color: #4A90E2; font-weight: bold; margin-bottom: 8px; display: block;">So tickst du meistens (70%)</label>
                            <div class="bindung-options" id="bindungPrimaryOptions">
                                <button class="bindung-btn" data-value="sicher" data-action="select-bindung" data-slot="primary" data-value="sicher" title="Du f√ºhlst dich meistens wohl mit N√§he und kannst gut Grenzen setzen">
                                    <span class="bindung-icon">üõ°Ô∏è</span>
                                    <span class="bindung-name">Sicher</span>
                                    <span class="bindung-desc">N√§he & Autonomie ok</span>
                                </button>
                                <button class="bindung-btn" data-value="aengstlich" data-action="select-bindung" data-slot="primary" data-value="aengstlich" title="Du suchst meistens viel N√§he und hast oft Angst, verlassen zu werden">
                                    <span class="bindung-icon">üíî</span>
                                    <span class="bindung-name">√Ñngstlich</span>
                                    <span class="bindung-desc">Angst vor Verlust</span>
                                </button>
                                <button class="bindung-btn" data-value="vermeidend" data-action="select-bindung" data-slot="primary" data-value="vermeidend" title="Du h√§ltst meistens emotionale Distanz und brauchst viel Freiraum">
                                    <span class="bindung-icon">üö™</span>
                                    <span class="bindung-name">Vermeidend</span>
                                    <span class="bindung-desc">H√§lt Distanz</span>
                                </button>
                                <button class="bindung-btn" data-value="desorganisiert" data-action="select-bindung" data-slot="primary" data-value="desorganisiert" title="Du schwankst meistens zwischen Sehnsucht nach N√§he und dem Drang zu fliehen">
                                    <span class="bindung-icon">üåÄ</span>
                                    <span class="bindung-name">Desorganisiert</span>
                                    <span class="bindung-desc">Will N√§he & fl√ºchtet</span>
                                </button>
                            </div>
                        </div>

                        <div class="bindung-group" style="margin-top: 20px;">
                            <label style="color: #4A90E2; font-weight: bold; margin-bottom: 8px; display: block;">So tickst du im Stress (30%)</label>
                            <div class="bindung-options" id="bindungSecondaryOptions">
                                <button class="bindung-btn" data-value="sicher" data-action="select-bindung" data-slot="secondary" data-value="sicher" title="Im Stress bleibst du gelassen und kannst dich gut regulieren">
                                    <span class="bindung-icon">üõ°Ô∏è</span>
                                    <span class="bindung-name">Sicher</span>
                                </button>
                                <button class="bindung-btn" data-value="aengstlich" data-action="select-bindung" data-slot="secondary" data-value="aengstlich" title="Im Stress wirst du klammernder und brauchst mehr Best√§tigung">
                                    <span class="bindung-icon">üíî</span>
                                    <span class="bindung-name">√Ñngstlich</span>
                                </button>
                                <button class="bindung-btn" data-value="vermeidend" data-action="select-bindung" data-slot="secondary" data-value="vermeidend" title="Im Stress ziehst du dich zur√ºck und machst dicht">
                                    <span class="bindung-icon">üö™</span>
                                    <span class="bindung-name">Vermeidend</span>
                                </button>
                                <button class="bindung-btn" data-value="desorganisiert" data-action="select-bindung" data-slot="secondary" data-value="desorganisiert" title="Im Stress reagierst du unberechenbar - mal nah, mal distanziert">
                                    <span class="bindung-icon">üåÄ</span>
                                    <span class="bindung-name">Desorganisiert</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- RTI-S√§ulen Priorit√§ten (5 S√§ulen nach Petzold) -->
                    <div class="reibung-questions" style="margin-top: 24px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                        <label style="color: #F4A261; font-weight: bold; margin-bottom: 8px; display: block;">
                            üèõÔ∏è RTI-S√§ulen Priorit√§ten
                        </label>
                        <p style="color: rgba(255,255,255,0.5); font-size: 10px; margin-bottom: 12px;">
                            0 = Egal ¬∑ 1 = Normal ¬∑ 2 = Wichtig
                        </p>

                        <!-- S1: Leiblichkeit (K√∂rperliche Anziehung) -->
                        <div class="rti-toggle-row" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <span style="color: #E84393; font-size: 11px; min-width: 24px; font-weight: 600;">S1</span>
                            <span data-action="open-rti-pillar-modal" data-pillar="S1" style="color: var(--text-secondary); font-size: 11px; flex: 1; cursor: pointer;" title="Klicken f√ºr Definition">ü´Ä Leiblichkeit</span>
                            <div class="rti-toggle-group" id="rtiToggleS1" style="display: flex; gap: 2px;">
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S1" data-value="0" style="font-size: 11px; padding: 4px 8px;">0</button>
                                <button class="agod-toggle-btn active" data-action="set-rti-priority" data-pillar="S1" data-value="1" style="font-size: 11px; padding: 4px 8px;">1</button>
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S1" data-value="2" style="font-size: 11px; padding: 4px 8px;">2</button>
                            </div>
                        </div>

                        <!-- S2: Soziales Netzwerk (Beziehungsform) -->
                        <div class="rti-toggle-row" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <span style="color: #3B82F6; font-size: 11px; min-width: 24px; font-weight: 600;">S2</span>
                            <span data-action="open-rti-pillar-modal" data-pillar="S2" style="color: var(--text-secondary); font-size: 11px; flex: 1; cursor: pointer;" title="Klicken f√ºr Definition">üë• Soziales Netzwerk</span>
                            <div class="rti-toggle-group" id="rtiToggleS2" style="display: flex; gap: 2px;">
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S2" data-value="0" style="font-size: 11px; padding: 4px 8px;">0</button>
                                <button class="agod-toggle-btn active" data-action="set-rti-priority" data-pillar="S2" data-value="1" style="font-size: 11px; padding: 4px 8px;">1</button>
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S2" data-value="2" style="font-size: 11px; padding: 4px 8px;">2</button>
                            </div>
                        </div>

                        <!-- S3: Autonomie & Leistung -->
                        <div class="rti-toggle-row" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <span style="color: #22c55e; font-size: 11px; min-width: 24px; font-weight: 600;">S3</span>
                            <span data-action="open-rti-pillar-modal" data-pillar="S3" style="color: var(--text-secondary); font-size: 11px; flex: 1; cursor: pointer;" title="Klicken f√ºr Definition">üéØ Autonomie</span>
                            <div class="rti-toggle-group" id="rtiToggleS3" style="display: flex; gap: 2px;">
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S3" data-value="0" style="font-size: 11px; padding: 4px 8px;">0</button>
                                <button class="agod-toggle-btn active" data-action="set-rti-priority" data-pillar="S3" data-value="1" style="font-size: 11px; padding: 4px 8px;">1</button>
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S3" data-value="2" style="font-size: 11px; padding: 4px 8px;">2</button>
                            </div>
                        </div>

                        <!-- S4: Sicherheit & Stabilit√§t -->
                        <div class="rti-toggle-row" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <span style="color: #f59e0b; font-size: 11px; min-width: 24px; font-weight: 600;">S4</span>
                            <span data-action="open-rti-pillar-modal" data-pillar="S4" style="color: var(--text-secondary); font-size: 11px; flex: 1; cursor: pointer;" title="Klicken f√ºr Definition">üõ°Ô∏è Sicherheit</span>
                            <div class="rti-toggle-group" id="rtiToggleS4" style="display: flex; gap: 2px;">
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S4" data-value="0" style="font-size: 11px; padding: 4px 8px;">0</button>
                                <button class="agod-toggle-btn active" data-action="set-rti-priority" data-pillar="S4" data-value="1" style="font-size: 11px; padding: 4px 8px;">1</button>
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S4" data-value="2" style="font-size: 11px; padding: 4px 8px;">2</button>
                            </div>
                        </div>

                        <!-- S5: Werte & Sinn -->
                        <div class="rti-toggle-row" style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #8b5cf6; font-size: 11px; min-width: 24px; font-weight: 600;">S5</span>
                            <span data-action="open-rti-pillar-modal" data-pillar="S5" style="color: var(--text-secondary); font-size: 11px; flex: 1; cursor: pointer;" title="Klicken f√ºr Definition">üí´ Werte & Sinn</span>
                            <div class="rti-toggle-group" id="rtiToggleS5" style="display: flex; gap: 2px;">
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S5" data-value="0" style="font-size: 11px; padding: 4px 8px;">0</button>
                                <button class="agod-toggle-btn active" data-action="set-rti-priority" data-pillar="S5" data-value="1" style="font-size: 11px; padding: 4px 8px;">1</button>
                                <button class="agod-toggle-btn" data-action="set-rti-priority" data-pillar="S5" data-value="2" style="font-size: 11px; padding: 4px 8px;">2</button>
                            </div>
                        </div>
                    </div>

                    <button class="slot-start-btn" id="slotStartBtn" data-action="start-slot-machine" disabled style="margin-top: 25px;">
                        üé∞ Suche starten
                    </button>
                </div>

                <!-- Phase 2: Slot Machine Animation -->
                <div id="slotPhase2" class="slot-phase" style="display: none;">
                    <h3 style="color: #e94560; margin-bottom: 20px; text-align: center;">Berechne beste Kombination...</h3>

                    <div class="slot-machine-display">
                        <div class="slot-reel" id="slotReelA">
                            <div class="slot-label">A</div>
                            <div class="slot-value" id="slotValueA">-</div>
                        </div>
                        <div class="slot-reel" id="slotReelG">
                            <div class="slot-label">G</div>
                            <div class="slot-value" id="slotValueG">-</div>
                        </div>
                        <div class="slot-reel" id="slotReelO">
                            <div class="slot-label">O</div>
                            <div class="slot-value" id="slotValueO">-</div>
                        </div>
                        <div class="slot-reel" id="slotReelD">
                            <div class="slot-label">D</div>
                            <div class="slot-value" id="slotValueD">-</div>
                        </div>
                    </div>

                    <div class="slot-score-display">
                        <div class="slot-score-label">Score</div>
                        <div class="slot-score-value" id="slotScoreValue">0</div>
                    </div>

                    <div class="slot-progress">
                        <div class="slot-progress-bar" id="slotProgressBar"></div>
                    </div>
                    <div class="slot-progress-text" id="slotProgressText">0 / 864 Kombinationen</div>
                </div>

                <!-- Phase 3: Top N Ergebnisse (erweiterbar) -->
                <div id="slotPhase3" class="slot-phase" style="display: none;">
                    <h3 id="slotResultTitle" style="color: #00d26a; margin-bottom: 15px; text-align: center;">üèÜ Top 4 Partner gefunden!</h3>

                    <div class="slot-top4-list" id="slotTop4List">
                        <!-- Wird dynamisch gef√ºllt -->
                    </div>

                    <!-- Erweiterte Liste (Position 5+) -->
                    <div class="slot-expanded-list" id="slotExpandedList" style="display: none;">
                        <!-- Wird dynamisch gef√ºllt -->
                    </div>

                    <div class="slot-expand-toggle" style="text-align: center; margin: 10px 0;">
                        <button id="slotExpandBtn" class="slot-expand-btn" data-action="toggle-slot-expand" style="background: rgba(0,210,106,0.2); border: 1px solid #00d26a; color: #00d26a; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
                            ‚ñº Mehr anzeigen (5-10)
                        </button>
                    </div>

                    <div class="slot-result-actions" style="margin-top: 15px;">
                        <button class="slot-retry-btn" data-action="go-to-ich-attributes">‚öôÔ∏è ICH-Attribute anpassen</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Factor Detail Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="factorModal" data-action="close-factor-modal">
        <div class="modal" data-stop-propagation>
            <div class="modal-header">
                <span class="modal-title" id="factorModalTitle">Faktor-Details</span>
                <button class="modal-close" data-action="close-factor-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p class="modal-subtitle" id="factorModalSubtitle"></p>
                <!-- Archetype Selection with Navigation -->
                <div id="factorModalArchetypeNav" style="display: flex; flex-direction: column; gap: 8px; margin-bottom: 15px;">
                    <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <span style="font-size: 11px; color: var(--text-muted); min-width: 50px;">DU:</span>
                        <button class="archetype-nav-btn" data-action="navigate-factor-archetype" data-person="ich" data-direction="-1" title="Vorheriger Archetyp">&#8249;</button>
                        <span id="factorModalIchCode" style="font-size: 12px; color: var(--text-primary); background: rgba(255,255,255,0.08); padding: 4px 12px; border-radius: 6px; min-width: 80px; text-align: center; font-weight: 600;">Single</span>
                        <button class="archetype-nav-btn" data-action="navigate-factor-archetype" data-person="ich" data-direction="1" title="N√§chster Archetyp">&#8250;</button>
                    </div>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                        <span style="font-size: 11px; color: var(--text-muted); min-width: 50px;">Partner:</span>
                        <button class="archetype-nav-btn" data-action="navigate-factor-archetype" data-person="partner" data-direction="-1" title="Vorheriger Archetyp">&#8249;</button>
                        <span id="factorModalPartnerCode" style="font-size: 12px; color: var(--text-primary); background: rgba(255,255,255,0.08); padding: 4px 12px; border-radius: 6px; min-width: 80px; text-align: center; font-weight: 600;">Duo</span>
                        <button class="archetype-nav-btn" data-action="navigate-factor-archetype" data-person="partner" data-direction="1" title="N√§chster Archetyp">&#8250;</button>
                    </div>
                </div>
                <div id="factorModalComboCode" style="font-size: 11px; color: var(--text-muted); background: rgba(255,255,255,0.05); padding: 4px 10px; border-radius: 6px; display: inline-block; margin-bottom: 10px; font-family: monospace;"></div>
                <div class="score-display" id="factorModalScore">0</div>
                <div class="explanation">
                    <h4>Warum dieser Score?</h4>
                    <p id="factorModalExplanation"></p>
                    <h4>Was bedeutet das?</h4>
                    <ul id="factorModalMeaning"></ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Ti-Age Synthese Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="tiageSyntheseModal" data-action="close-synthese-modal">
        <!-- Sticky side toggle buttons for Score, Pathos and Logos - positioned in overlay, right side of modal -->
        <div id="tiageSyntheseStickyToggle" data-stop-propagation style="position: fixed; left: min(calc(50% + 360px), calc(100% - 60px)); top: 50%; transform: translateY(-50%); display: flex; flex-direction: column; gap: 8px; z-index: 1002;">
            <button id="tiageSyntheseToggleScore" data-action="show-synthese-content" data-tab="score" style="padding: 12px 14px; border-radius: 8px; border: 1px solid var(--border); background: rgba(30,30,35,0.95); color: var(--text-muted); cursor: pointer; font-size: 16px; transition: all 0.2s; backdrop-filter: blur(10px); box-shadow: 0 2px 12px rgba(0,0,0,0.4);" title="Score - Pro & Contra">üìä</button>
            <button id="tiageSyntheseToggleOshoZen" data-action="show-synthese-content" data-tab="oshozen" style="padding: 12px 14px; border-radius: 8px; border: 2px solid var(--border); background: transparent; color: var(--text-muted); cursor: pointer; font-size: 16px; transition: all 0.2s; backdrop-filter: blur(10px); box-shadow: 0 2px 12px rgba(0,0,0,0.4);" title="Osho Zen - Gemeinsame Bed√ºrfnisse">üî•</button>
            <button id="tiageSyntheseToggleNeeds" data-action="show-synthese-content" data-tab="needs" style="padding: 12px 14px; border-radius: 8px; border: 2px solid var(--border); background: transparent; color: var(--text-muted); cursor: pointer; font-size: 16px; transition: all 0.2s; backdrop-filter: blur(10px); box-shadow: 0 2px 12px rgba(0,0,0,0.4);" title="Bed√ºrfnis-Match mit Differenz">üíö</button>
            <button id="tiageSyntheseToggleRTI" data-action="show-synthese-content" data-tab="rti" style="padding: 12px 14px; border-radius: 8px; border: 2px solid var(--border); background: transparent; color: var(--text-muted); cursor: pointer; font-size: 16px; transition: all 0.2s; backdrop-filter: blur(10px); box-shadow: 0 2px 12px rgba(0,0,0,0.4);" title="5 S√§ulen der Identit√§t (RTI)">üèõÔ∏è</button>
            <button id="tiageSyntheseToggleResonanz" data-action="open-resonanz-modal" style="padding: 12px 14px; border-radius: 8px; border: 1px solid var(--border); background: rgba(30,30,35,0.95); color: var(--text-muted); cursor: pointer; font-size: 16px; transition: all 0.2s; backdrop-filter: blur(10px); box-shadow: 0 2px 12px rgba(0,0,0,0.4);" title="Resonanzfaktoren √ó Perspektiven">üéõÔ∏è</button>
        </div>
        <div class="modal" data-stop-propagation style="max-width: 700px; max-height: 85vh; overflow-y: auto; position: relative;">
            <div class="modal-header">
                <span class="modal-title" id="tiageSyntheseModalTitle">Ti-Age Synthese</span>
                <div style="display: flex; align-items: center; gap: 8px;">
                    <button class="header-score-btn" id="modalScoreBtn" data-action="show-synthese-content" data-tab="score" title="Score - Pro & Contra">üìä</button>
                    <button class="header-oshozen-btn" id="modalOshoZenBtn" data-action="show-synthese-content" data-tab="oshozen" title="Osho Zen - Gemeinsame Bed√ºrfnisse">üî•</button>
                    <button class="header-needs-btn" id="modalNeedsBtn" data-action="show-synthese-content" data-tab="needs" title="Bed√ºrfnis-Match mit Differenz">üíö</button>
                    <button class="header-rti-btn" id="modalRTIBtn" data-action="show-synthese-content" data-tab="rti" title="5 S√§ulen der Identit√§t (RTI)">üèõÔ∏è</button>
                    <button class="header-resonanz-btn" id="modalResonanzBtn" data-action="open-resonanz-modal" title="Resonanzfaktoren √ó Perspektiven">üéõÔ∏è</button>
                    <button class="modal-close" data-action="close-synthese-modal">&times;</button>
                </div>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <!-- Archetype context with navigation - harmonized horizontal layout -->
                <div id="tiageSyntheseArchetypeContext" style="display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 15px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                    <!-- ICH Navigation (links) -->
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <button class="archetype-nav-btn" data-action="navigate-synthese-archetype" data-person="ich" data-direction="-1" title="Vorheriger Archetyp" style="width: 28px; height: 28px; font-size: 1.2rem;">‚Äπ</button>
                        <div style="text-align: center; min-width: 90px;">
                            <div style="font-size: 10px; color: var(--success); font-weight: 600; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px;">ICH</div>
                            <div style="font-size: 13px; color: var(--text-primary); font-weight: 600;" id="tiageSyntheseModalIch">Duo</div>
                        </div>
                        <button class="archetype-nav-btn" data-action="navigate-synthese-archetype" data-person="ich" data-direction="1" title="N√§chster Archetyp" style="width: 28px; height: 28px; font-size: 1.2rem;">‚Ä∫</button>
                    </div>
                    <div style="font-size: 18px; color: var(--text-muted);">√ó</div>
                    <!-- PARTNER Navigation (rechts) -->
                    <div style="display: flex; align-items: center; gap: 6px;">
                        <button class="archetype-nav-btn" data-action="navigate-synthese-archetype" data-person="partner" data-direction="-1" title="Vorheriger Archetyp" style="width: 28px; height: 28px; font-size: 1.2rem;">‚Äπ</button>
                        <div style="text-align: center; min-width: 90px;">
                            <div style="font-size: 10px; color: var(--danger); font-weight: 600; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px;">PARTNER</div>
                            <div style="font-size: 13px; color: var(--text-primary); font-weight: 600;" id="tiageSyntheseModalPartner">Poly Hedo</div>
                        </div>
                        <button class="archetype-nav-btn" data-action="navigate-synthese-archetype" data-person="partner" data-direction="1" title="N√§chster Archetyp" style="width: 28px; height: 28px; font-size: 1.2rem;">‚Ä∫</button>
                    </div>
                </div>
                <!-- Type indicator (hidden for Score view) -->
                <div id="tiageSyntheseTypeIndicator" style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid var(--border);">
                    <span style="font-size: 24px;" id="tiageSyntheseIcon">üìä</span>
                    <div style="flex: 1;">
                        <div style="font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; display: flex; align-items: center; gap: 6px;" id="tiageSyntheseCategory">
                            <span>Kompatibilit√§ts-Analyse</span>
                            <span style="cursor: help; font-size: 14px;" title="Statistischer Score basierend auf Archetypen-Forschungsdaten. Der Gesamt-Score ber√ºcksichtigt zus√§tzlich individuelle Dimensionen (Orientierung, Dominanz, Geschlecht) und Bed√ºrfnis-√úbereinstimmung mit personalisierten Modifikatoren und Resonanzfaktoren.">‚ÑπÔ∏è</span>
                        </div>
                        <div style="font-size: 14px; color: var(--text-primary); font-weight: 600;" id="tiageSyntheseSubtitle">Statistische Archetypen-√úbereinstimmung</div>
                    </div>
                </div>
                <!-- Main content -->
                <div id="tiageSyntheseModalContent" style="font-size: 15px; line-height: 1.7; color: var(--text-secondary);">
                    <!-- Content will be injected here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Resonanzfaktoren Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="resonanzfaktorenModal" data-action="close-resonanz-modal">
        <div class="modal" data-stop-propagation style="max-width: 600px; max-height: 85vh; overflow-y: auto;">
            <div class="modal-header">
                <span class="modal-title">Resonanzfaktoren</span>
                <button class="modal-close" data-action="close-resonanz-modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <div style="display: flex; justify-content: flex-end; margin-bottom: 12px;">
                    <button class="profile-review-triple-btn" data-action="open-resonanz-help-modal" style="padding: 6px 12px; font-size: 11px;" title="Wie werden R-Faktoren berechnet?">
                        ‚Ñπ Berechnung anzeigen
                    </button>
                </div>
                <div id="resonanzfaktorenModalContent">
                    <!-- Content will be injected here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Archetype Info Modal (Feature 4) -->
    <!-- archetypeInfoModal wurde mit definitionModal zusammengef√ºhrt -->

    <header>
        <div class="header-content">
            <h1><span data-i18n="ui.title">DAS ANARCHISCHE TI-AGE PRINZIP DER PAARUNG</span></h1>
            <!-- Version Info oben rechts -->
            <div id="appVersion" class="app-version-box">
                <div class="version-line" id="versionLine"></div>
                <div class="merge-line" id="mergeLine"></div>
            </div>
            <div class="header-buttons">
                <button class="lang-btn" data-action="toggle-language" title="Switch Language / Sprache wechseln">
                    <span class="lang-icon">üåê</span>
                    <span class="lang-code" id="currentLangCode">DE</span>
                </button>
                <button class="memory-btn" data-action="open-memory-modal" title="Speichern / Laden">
                    <span class="memory-icon">üíæ</span>
                    <span class="memory-text">Save</span>
                </button>
                <button class="clear-storage-btn" data-action="clear-all-storage" title="Alle gespeicherten Daten l√∂schen und UI zur√ºcksetzen">
                    <span class="clear-icon">üóëÔ∏è</span>
                    <span class="clear-text">Leeren</span>
                </button>
                <a href="docs.html?doc=docs/help-guide.md" class="help-btn" title="Hilfe & Dokumentation">?</a>
            </div>
        </div>
    </header>

    <!-- Visitor Info Bar -->
    <div class="visitor-info-bar" id="visitorInfoBar">
        <span class="visitor-id-badge">üë§ Besucher <span id="headerVisitorId">#----</span></span>
        <span class="privacy-notice" title="Es werden keine personenbezogenen Daten gespeichert">üîí Anonym ‚Äì keine personenbezogenen Daten</span>
    </div>

    <!-- Philosophy Greeting Hint Container -->
    <div id="greetingHintContainer" class="greeting-hint-container"></div>

    <!-- Desktop Selection Info Message -->
    <div class="selection-info-message" id="desktopSelectionInfo"></div>

    <!-- NEW: Side-by-Side Comparison Layout (Desktop) -->
    <div class="comparison-container desktop-mode" id="comparisonView">
        <!-- Two Column Grid -->
        <div class="comparison-grid">
            <!-- ICH Column -->
            <div class="comparison-column ich-column">
                <div class="column-header">
                    <div class="column-icon">üë§</div>
                    <div class="column-title">DU <span id="ich-profile-status" class="profile-status-badge"></span></div>
                </div>
                <div class="select-with-info">
                    <button class="archetype-nav-btn" data-action="navigate-archetype" data-person="ich" data-direction="-1" title="Vorheriger Archetyp">&#9664;</button>
                    <select class="column-select" id="ichSelect">
                        <option value="single" title="Bewusste Entscheidung f√ºr ein autonomes Leben ohne Prim√§rbeziehung">Single</option>
                        <option value="duo" title="Traditionelle monogame Zweierbeziehung mit Exklusivit√§t">Duo</option>
                        <option value="duo_flex" title="Prim√§re Zweierbeziehung mit vereinbarten √ñffnungen">Duo-Flex</option>
                        <option value="solopoly" title="Mehrere gleichwertige Beziehungen bei Bewahrung der Autonomie">Solopoly</option>
                        <option value="polyamor" title="Mehrere gleichzeitige, ethisch gef√ºhrte Liebesbeziehungen">Polyamor</option>
                        <option value="ra" title="RA - Ablehnung aller Beziehungs-Hierarchien und Labels">RA</option>
                        <option value="lat" title="Living Apart Together - Feste Partnerschaft ohne Zusammenleben">LAT</option>
                        <option value="aromantisch" title="Fokus auf platonische Verbindungen ohne romantische Komponente">Aromantisch</option>
                    </select>
                    <button class="archetype-nav-btn" data-action="navigate-archetype" data-person="ich" data-direction="1" title="N√§chster Archetyp">&#9654;</button>
                    <button class="archetype-info-btn" data-action="show-archetype-info" data-person="ich" title="Info zum Archetyp">INFO</button>
                </div>
                <!-- Archetypen-Symbol-Grid f√ºr ICH -->
                <div class="archetype-symbols-grid" id="ich-archetype-grid">
                    <div class="archetype-symbol-item active" data-archetype="single" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=single&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚òÖ</span>
                        <span class="archetype-symbol-name">Single</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="duo" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=duo&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚ô°</span>
                        <span class="archetype-symbol-name">Duo</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="duo_flex" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=duo_flex&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚ö°</span>
                        <span class="archetype-symbol-name">Duo-Flex</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="solopoly" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=solopoly&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚óÜ</span>
                        <span class="archetype-symbol-name">Solopoly</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="polyamor" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=polyamor&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚ô•</span>
                        <span class="archetype-symbol-name">Polyamor</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="ra" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=ra&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚àû</span>
                        <span class="archetype-symbol-name">RA</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="lat" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=lat&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚åÇ</span>
                        <span class="archetype-symbol-name">LAT</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="aromantisch" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=aromantisch&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚óá</span>
                        <span class="archetype-symbol-name">Aromantisch</span>
                    </div>
                </div>
                <div class="header-geschlecht-info" id="ich-header-geschlecht"></div>
                <div class="header-geschlecht-info" id="ich-header-dominanz"></div>
                <div class="header-geschlecht-info" id="ich-header-orientierung"></div>
                <!-- Spacer for symmetry with Partner FREE button -->
                <div style="display: flex; justify-content: center; margin: 8px 0; height: 32px;"></div>
                <div class="column-dimensions">
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="ich-geschlecht-multi">
                        <div class="compact-dimension-label"><span class="geschlecht-info-link">Geschlecht</span> <span id="ich-geschlecht-legend" class="geschlecht-legend" style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-body-soul-modal"></span></div>
                        <div class="collapsed-summary" id="ich-geschlecht-summary"></div>
                        <div class="geschlecht-primary-row">
                            <div class="geschlecht-grid geschlecht-p-grid" id="ich-geschlecht-p-grid" data-person="ich"></div>
                        </div>
                        <div class="geschlecht-secondary-row" id="ich-geschlecht-s-row" style="display: none;">
                            <div class="geschlecht-grid geschlecht-s-grid" id="ich-geschlecht-s-grid" data-person="ich"></div>
                        </div>
                        <div class="geschlecht-extras-row">
                            <div class="geschlecht-grid geschlecht-extras-grid" id="ich-geschlecht-extras-grid" data-person="ich"></div>
                        </div>
                    </div>
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="ich-orientierung-multi">
                        <div class="compact-dimension-label"><span class="orientierung-info-link">Orientierung</span> <span id="ich-orientierung-legend" class="geschlecht-legend" style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip" data-tooltip-key="orientierungKO" title="KO-Kriterien anzeigen">(<span class="legend-p">P</span>=Prim√§r, <span class="legend-s">S</span>=Sekund√§r - <strong>Regeln</strong>)</span></div>
                        <div class="collapsed-summary" id="ich-orientierung-summary"></div>
                        <div class="orientierung-grid" id="ich-orientierung-grid" data-person="ich"></div>
                    </div>
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="ich-dominanz-multi">
                        <div class="compact-dimension-label"><span class="dominanz-info-link">Dominanz</span> <span id="ich-dominanz-legend" class="geschlecht-legend" style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip" data-tooltip-key="dominanzStatus">(<span class="legend-p">P</span>=Prim√§r, <span class="legend-s">S</span>=Sekund√§r)</span></div>
                        <div class="collapsed-summary" id="ich-dominanz-summary"></div>
                        <div class="dominanz-grid" id="ich-dominanz-grid" data-person="ich"></div>
                    </div>
                    <div class="compact-dimension collapsible-dimension" data-dimension="ich-gfk">
                        <div class="compact-dimension-label"><span class="gfk-info-link">GFK-Kompetenz</span></div>
                        <div class="collapsed-summary" id="ich-gfk-summary"></div>
                        <div class="gfk-grid" id="ich-gfk-grid" data-person="ich"></div>
                    </div>
                </div>
            </div>

            <!-- Center Column - Lightbulb Button & Score Circle -->
            <div class="center-column">
                <!-- R-Faktor Display (Resonanz der Paarung) -->
                <div class="r-factor-display" id="rFactorDisplay">
                    <div class="r-factor-box" id="rFactorR1" title="R1 - Leben (Orientierung)">
                        <span class="r-factor-label">R1</span>
                        <span class="r-factor-value" id="rValueR1">-</span>
                    </div>
                    <div class="r-factor-box" id="rFactorR2" title="R2 - Philosophie (Archetyp)">
                        <span class="r-factor-label">R2</span>
                        <span class="r-factor-value" id="rValueR2">-</span>
                    </div>
                    <div class="r-factor-box" id="rFactorR3" title="R3 - Kink (Dominanz)">
                        <span class="r-factor-label">R3</span>
                        <span class="r-factor-value" id="rValueR3">-</span>
                    </div>
                    <div class="r-factor-box" id="rFactorR4" title="R4 - Identit√§t (Geschlecht)">
                        <span class="r-factor-label">R4</span>
                        <span class="r-factor-value" id="rValueR4">-</span>
                    </div>
                </div>
                <!-- AGOD Weight Toggles (3-Wege-Schalter) - Sortierung: A, G, O, D -->
                <div class="agod-heading" style="text-align: center; margin-bottom: 8px;">
                    <div style="color: #F59E0B; font-size: 14px; font-weight: 600;">Gewichtung</div>
                    <div style="color: var(--text-muted); font-size: 10px;">0 = Egal ¬∑ 1 = Normal ¬∑ 2 = Wichtig</div>
                </div>
                <div class="agod-weight-toggles" id="agodWeightToggles">
                    <div class="agod-toggle-row" data-factor="A" title="Archetyp - Gewichtung">
                        <span class="agod-toggle-label">Archetyp</span>
                        <div class="agod-toggle-group" id="agodToggleA">
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="A" data-value="0">0</button>
                            <button type="button" class="agod-toggle-btn active" data-action="set-agod-weight" data-dimension="A" data-value="1">1</button>
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="A" data-value="2">2</button>
                        </div>
                    </div>
                    <div class="agod-toggle-row" data-factor="G" title="Geschlecht - Gewichtung">
                        <span class="agod-toggle-label">Geschlecht</span>
                        <div class="agod-toggle-group" id="agodToggleG">
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="G" data-value="0">0</button>
                            <button type="button" class="agod-toggle-btn active" data-action="set-agod-weight" data-dimension="G" data-value="1">1</button>
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="G" data-value="2">2</button>
                        </div>
                    </div>
                    <div class="agod-toggle-row" data-factor="O" title="Orientierung - Gewichtung">
                        <span class="agod-toggle-label">Orientierung</span>
                        <div class="agod-toggle-group" id="agodToggleO">
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="O" data-value="0">0</button>
                            <button type="button" class="agod-toggle-btn active" data-action="set-agod-weight" data-dimension="O" data-value="1">1</button>
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="O" data-value="2">2</button>
                        </div>
                    </div>
                    <div class="agod-toggle-row" data-factor="D" title="Dominanz - Gewichtung">
                        <span class="agod-toggle-label">Dominanz</span>
                        <div class="agod-toggle-group" id="agodToggleD">
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="D" data-value="0">0</button>
                            <button type="button" class="agod-toggle-btn active" data-action="set-agod-weight" data-dimension="D" data-value="1">1</button>
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="D" data-value="2">2</button>
                        </div>
                    </div>
                </div>
                <!-- Score Label -->
                <div class="score-label">Ti-Age Synthese Score</div>
                <!-- Lightbulb Button (moved to top) -->
                <div class="lightbulb-button" data-action="open-tiage-synthese" title="Ti-Age Synthese √∂ffnen">
                    <span class="lightbulb-icon">üí°</span>
                </div>
                <!-- Score Circle (moved to bottom) -->
                <div class="score-circle-display" id="mainScoreCircle" title="Ti-Age Synthese Score">
                    <svg viewBox="0 0 100 100">
                        <circle class="score-bg" cx="50" cy="50" r="42"></circle>
                        <circle class="score-progress" id="mainScoreProgress" cx="50" cy="50" r="42" stroke-dasharray="264" stroke-dashoffset="264"></circle>
                    </svg>
                    <div class="score-circle-value" id="mainScoreValue">0</div>
                </div>
                <!-- KO-Text Display (unter dem Score Circle) -->
                <div id="desktopKoTextDisplay" class="desktop-ko-text-display" style="display: none;"></div>
                <!-- Slot Machine Button - Finde passenden Partner -->
                <button class="best-match-btn slot-machine-center-btn" data-action="open-slot-machine-modal" title="Finde den besten Partner - testet alle 864 Kombinationen">
                    <span class="match-icon">üé∞</span>
                    <span class="match-text">FINDE PASSENDEN PARTNER</span>
                </button>
            </div>

            <!-- PARTNER Column -->
            <div class="comparison-column partner-column">
                <div class="column-header">
                    <div class="column-icon">üë•</div>
                    <div class="column-title">PARTNER <span id="partner-profile-status" class="profile-status-badge"></span></div>
                </div>
                <div class="select-with-info">
                    <button class="archetype-nav-btn" data-action="navigate-archetype" data-person="partner" data-direction="-1" title="Vorheriger Archetyp">&#9664;</button>
                    <select class="column-select" id="partnerSelect">
                        <option value="single" title="Bewusste Entscheidung f√ºr ein autonomes Leben ohne Prim√§rbeziehung">Single</option>
                        <option value="duo" selected title="Traditionelle monogame Zweierbeziehung mit Exklusivit√§t">Duo</option>
                        <option value="duo_flex" title="Prim√§re Zweierbeziehung mit vereinbarten √ñffnungen">Duo-Flex</option>
                        <option value="solopoly" title="Mehrere gleichwertige Beziehungen bei Bewahrung der Autonomie">Solopoly</option>
                        <option value="polyamor" title="Mehrere gleichzeitige, ethisch gef√ºhrte Liebesbeziehungen">Polyamor</option>
                        <option value="ra" title="RA - Ablehnung aller Beziehungs-Hierarchien und Labels">RA</option>
                        <option value="lat" title="Living Apart Together - Feste Partnerschaft ohne Zusammenleben">LAT</option>
                        <option value="aromantisch" title="Fokus auf platonische Verbindungen ohne romantische Komponente">Aromantisch</option>
                    </select>
                    <button class="archetype-nav-btn" data-action="navigate-archetype" data-person="partner" data-direction="1" title="N√§chster Archetyp">&#9654;</button>
                    <button class="archetype-info-btn" data-action="show-archetype-info" data-person="partner" title="Info zum Archetyp">INFO</button>
                </div>
                <!-- Archetypen-Symbol-Grid f√ºr PARTNER -->
                <div class="archetype-symbols-grid" id="partner-archetype-grid">
                    <div class="archetype-symbol-item" data-archetype="single" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚òÖ</span>
                        <span class="archetype-symbol-name">Single</span>
                    </div>
                    <div class="archetype-symbol-item active" data-archetype="duo" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚ô°</span>
                        <span class="archetype-symbol-name">Duo</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="duo_flex" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚ö°</span>
                        <span class="archetype-symbol-name">Duo-Flex</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="solopoly" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚óÜ</span>
                        <span class="archetype-symbol-name">Solopoly</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="polyamor" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚ô•</span>
                        <span class="archetype-symbol-name">Polyamor</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="ra" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚àû</span>
                        <span class="archetype-symbol-name">RA</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="lat" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚åÇ</span>
                        <span class="archetype-symbol-name">LAT</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="aromantisch" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚óá</span>
                        <span class="archetype-symbol-name">Aromantisch</span>
                    </div>
                </div>
                <div class="header-geschlecht-info" id="partner-header-geschlecht"></div>
                <div class="header-geschlecht-info" id="partner-header-dominanz"></div>
                <div class="header-geschlecht-info" id="partner-header-orientierung"></div>
                <!-- FREE Button - Reset Partner GOD -->
                <div style="display: flex; justify-content: center; margin: 8px 0;">
                    <button type="button" data-action="reset-partner-god" class="free-reset-btn" style="padding: 6px 16px; background: linear-gradient(135deg, #f59e0b, #eab308); border: 2px solid #ca8a04; border-radius: 6px; color: #1a1a2e; font-weight: 700; font-size: 12px; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; transition: all 0.2s; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);" title="Partner GOD (Geschlecht, Orientierung, Dominanz) zur√ºcksetzen">FREE</button>
                </div>
                <div class="column-dimensions">
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="partner-geschlecht-multi">
                        <div class="compact-dimension-label"><span class="geschlecht-info-link">Geschlecht</span> <span id="partner-geschlecht-legend" class="geschlecht-legend" style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-body-soul-modal"></span></div>
                        <div class="collapsed-summary" id="partner-geschlecht-summary"></div>
                        <div class="geschlecht-primary-row">
                            <div class="geschlecht-grid geschlecht-p-grid" id="partner-geschlecht-p-grid" data-person="partner"></div>
                        </div>
                        <div class="geschlecht-secondary-row" id="partner-geschlecht-s-row" style="display: none;">
                            <div class="geschlecht-grid geschlecht-s-grid" id="partner-geschlecht-s-grid" data-person="partner"></div>
                        </div>
                        <div class="geschlecht-extras-row">
                            <div class="geschlecht-grid geschlecht-extras-grid" id="partner-geschlecht-extras-grid" data-person="partner"></div>
                        </div>
                    </div>
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="partner-orientierung-multi">
                        <div class="compact-dimension-label"><span class="orientierung-info-link">Orientierung</span> <span id="partner-orientierung-legend" class="geschlecht-legend" style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip" data-tooltip-key="orientierungKO" title="KO-Kriterien anzeigen">(<span class="legend-p">P</span>=Prim√§r, <span class="legend-s">S</span>=Sekund√§r - <strong>Regeln</strong>)</span></div>
                        <div class="collapsed-summary" id="partner-orientierung-summary"></div>
                        <div class="orientierung-grid" id="partner-orientierung-grid" data-person="partner"></div>
                    </div>
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="partner-dominanz-multi">
                        <div class="compact-dimension-label"><span class="dominanz-info-link">Dominanz</span> <span id="partner-dominanz-legend" class="geschlecht-legend" style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip" data-tooltip-key="dominanzStatus">(<span class="legend-p">P</span>=Prim√§r, <span class="legend-s">S</span>=Sekund√§r)</span></div>
                        <div class="collapsed-summary" id="partner-dominanz-summary"></div>
                        <div class="dominanz-grid" id="partner-dominanz-grid" data-person="partner"></div>
                    </div>
                    <div class="compact-dimension collapsible-dimension" data-dimension="partner-gfk">
                        <div class="compact-dimension-label"><span class="gfk-info-link">GFK-Kompetenz</span></div>
                        <div class="collapsed-summary" id="partner-gfk-summary"></div>
                        <div class="gfk-grid" id="partner-gfk-grid" data-person="partner"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GFK Bed√ºrfnis-Matching Anzeige -->
        <div id="gfk-beduerfnis-display" class="gfk-beduerfnis-display" style="display: none;">
            <!-- Wird dynamisch durch updateGfkBeduerfnisDisplay() gef√ºllt -->
        </div>

        <!-- Hidden elements for backwards compatibility -->
        <div id="warningsContainer" style="display: none;"></div>
        <div id="desktopScoreNote" class="score-note" style="display: none;"></div>
        <span id="resultIchType" style="display: none;">Single</span>
        <span id="resultPartnerType" style="display: none;">Duo</span>
        <div class="result-progress" style="display: none;">
            <div class="result-progress-fill" id="resultProgressFill" style="width: 0%; background: var(--primary);"></div>
        </div>
        <div class="result-percentage" id="resultPercentage" style="display: none;">0%</div>
        <div class="desktop-score-circle" id="desktopScoreCircle" style="display: none;">
            <span id="desktopCirclePercentage">0%</span>
        </div>
    </div>

    <!-- MOBILE: Multi-Page Swipe Interface -->
    <div class="mobile-multipage" id="mobileMultipage" style="display: none;">

        <!-- PAGE 1: Auswahl -->
        <div class="mobile-page active" id="mobilePage1" data-page="1" data-page-label="Seite 1: ICH">
            <h2 style="text-align: center; color: var(--text-primary); margin-bottom: 20px; font-size: var(--font-lg);">Beziehungsqualit√§t analysieren</h2>

            <!-- ICH Auswahl -->
            <div style="background: var(--bg-card); border-radius: 16px; border: 1px solid var(--border); border-top: 3px solid var(--success); padding: 15px; margin-bottom: 15px;">
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; color: var(--success); font-weight: 700; font-size: var(--font-lg);">
                    <span>üë§</span> DU <span id="mobile-ich-profile-status" class="profile-status-badge"></span>
                </div>
                <div style="display: flex; gap: 8px; align-items: center; margin-bottom: 12px;">
                    <button class="archetype-nav-btn" data-action="navigate-archetype" data-person="ich" data-direction="-1" title="Vorheriger Archetyp">&#9664;</button>
                    <select class="column-select" id="mobileIchSelect">
                        <option value="single" title="Bewusste Entscheidung f√ºr ein autonomes Leben ohne Prim√§rbeziehung">Single</option>
                        <option value="duo" title="Traditionelle monogame Zweierbeziehung mit Exklusivit√§t">Duo</option>
                        <option value="duo_flex" title="Prim√§re Zweierbeziehung mit vereinbarten √ñffnungen">Duo-Flex</option>
                        <option value="solopoly" title="Mehrere gleichwertige Beziehungen bei Bewahrung der Autonomie">Solopoly</option>
                        <option value="polyamor" title="Mehrere gleichzeitige, ethisch gef√ºhrte Liebesbeziehungen">Polyamor</option>
                        <option value="ra" title="RA - Ablehnung aller Beziehungs-Hierarchien und Labels">RA</option>
                        <option value="lat" title="Living Apart Together - Feste Partnerschaft ohne Zusammenleben">LAT</option>
                        <option value="aromantisch" title="Fokus auf platonische Verbindungen ohne romantische Komponente">Aromantisch</option>
                    </select>
                    <button class="archetype-nav-btn" data-action="navigate-archetype" data-person="ich" data-direction="1" title="N√§chster Archetyp">&#9654;</button>
                    <button data-action="open-archetype-info" data-person="ich" data-select-id="mobileIchSelect" style="padding: 12px 16px; background: rgba(255,255,255,0.1); border: 1px solid var(--border); border-radius: 8px; color: var(--text-secondary); cursor: pointer; font-size: 14px; font-weight: 600; letter-spacing: 0.5px;" title="Info zum Archetyp">INFO</button>
                </div>
                <!-- Archetypen-Symbol-Grid f√ºr ICH (Mobile) -->
                <div class="archetype-symbols-grid" id="mobile-ich-archetype-grid">
                    <div class="archetype-symbol-item active" data-archetype="single" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=single&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚òÖ</span>
                        <span class="archetype-symbol-name">Single</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="duo" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=duo&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚ô°</span>
                        <span class="archetype-symbol-name">Duo</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="duo_flex" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=duo_flex&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚ö°</span>
                        <span class="archetype-symbol-name">Duo-Flex</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="solopoly" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=solopoly&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚óÜ</span>
                        <span class="archetype-symbol-name">Solopoly</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="polyamor" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=polyamor&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚ô•</span>
                        <span class="archetype-symbol-name">Polyamor</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="ra" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=ra&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚àû</span>
                        <span class="archetype-symbol-name">RA</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="lat" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=lat&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚åÇ</span>
                        <span class="archetype-symbol-name">LAT</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="aromantisch" data-action="select-archetype" data-person="ich">
                        <a class="archetype-settings-link" href="needs-editor.html?archetype=aromantisch&person=ich" data-stop-propagation title="Bed√ºrfnisse anpassen">‚öôÔ∏è</a>
                        <span class="archetype-symbol-icon">‚óá</span>
                        <span class="archetype-symbol-name">Aromantisch</span>
                    </div>
                </div>
                <div class="mobile-header-info-container">
                    <div class="header-geschlecht-info" id="mobile-ich-header-geschlecht"></div>
                    <div class="header-geschlecht-info" id="mobile-ich-header-dominanz"></div>
                    <div class="header-geschlecht-info" id="mobile-ich-header-orientierung"></div>
                </div>
                <div class="column-dimensions" id="mobileIchDimensions">
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="mobile-ich-geschlecht-multi">
                        <div class="compact-dimension-label"><span class="geschlecht-info-link">Geschlechtsidentit√§t</span> <span id="mobile-ich-geschlecht-legend" class="geschlecht-legend" style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-body-soul-modal"></span></div>
                        <div class="collapsed-summary" id="mobile-ich-geschlecht-summary"></div>
                        <div class="geschlecht-primary-row">
                            <div class="geschlecht-grid geschlecht-p-grid" id="mobile-ich-geschlecht-p-grid" data-person="ich"></div>
                        </div>
                        <div class="geschlecht-secondary-row" id="mobile-ich-geschlecht-s-row" style="display: none;">
                            <div class="geschlecht-grid geschlecht-s-grid" id="mobile-ich-geschlecht-s-grid" data-person="ich"></div>
                        </div>
                        <div class="geschlecht-extras-row">
                            <div class="geschlecht-grid geschlecht-extras-grid" id="mobile-ich-geschlecht-extras-grid" data-person="ich"></div>
                        </div>
                    </div>
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="mobile-ich-dominanz-multi">
                        <div class="compact-dimension-label" data-action="toggle-dimension-collapse">
                            <span><span class="dominanz-info-link" data-stop-propagation>Dominanz</span> <span style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip-stop" data-tooltip-key="dominanzStatus">(P=Prim√§r, S=Sekund√§r)</span></span>
                            <span class="collapse-toggle">‚ñº</span>
                        </div>
                        <div class="collapsed-summary" id="mobile-ich-dominanz-summary"></div>
                        <div class="dominanz-multi-select">
                            <div class="dominanz-option-row" id="m-ich-d-dom-row">
                                <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="dominant" style="cursor: pointer;">dominant</span>
                                <div id="m-ich-d-dom-status" class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="ich" data-type="dominant">Gelebt</button>
                                    <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="ich" data-type="dominant">Interessiert</button>
                                </div>
                            </div>
                            <div class="dominanz-option-row" id="m-ich-d-sub-row">
                                <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="submissiv" style="cursor: pointer;">submissiv</span>
                                <div id="m-ich-d-sub-status" class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="ich" data-type="submissiv">Gelebt</button>
                                    <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="ich" data-type="submissiv">Interessiert</button>
                                </div>
                            </div>
                            <div class="dominanz-option-row" id="m-ich-d-sw-row">
                                <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="switch" style="cursor: pointer;">switch</span>
                                <div id="m-ich-d-sw-status" class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="ich" data-type="switch">Gelebt</button>
                                    <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="ich" data-type="switch">Interessiert</button>
                                </div>
                            </div>
                            <div class="dominanz-option-row" id="m-ich-d-aus-row">
                                <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="ausgeglichen" style="cursor: pointer;">ausgeglichen</span>
                                <div id="m-ich-d-aus-status" class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="ich" data-type="ausgeglichen">Gelebt</button>
                                    <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="ich" data-type="ausgeglichen">Interessiert</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="mobile-ich-orientierung-multi">
                        <div class="compact-dimension-label" data-action="toggle-dimension-collapse">
                            <span><span class="orientierung-info-link" data-stop-propagation>Orientierung</span> <span style="font-size: 10px;">(Mehrfachauswahl)</span></span>
                            <span class="collapse-toggle">‚ñº</span>
                        </div>
                        <div class="collapsed-summary" id="mobile-ich-orientierung-summary"></div>
                        <div class="orientierung-multi-select" id="mobile-ich-orientierung-grid" data-person="ich">
                            <div class="orientierung-option-row" id="m-ich-o-hetero-row" data-value="heterosexuell">
                                <span class="orientierung-label">Hetero</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="ich" data-type="heterosexuell">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="ich" data-type="heterosexuell">Sekund√§r</button>
                                </div>
                            </div>
                            <div class="orientierung-option-row" id="m-ich-o-gay-row" data-value="gay_lesbisch">
                                <span class="orientierung-label">Gay/Lesbisch</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="ich" data-type="gay_lesbisch">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="ich" data-type="gay_lesbisch">Sekund√§r</button>
                                </div>
                            </div>
                            <div class="orientierung-option-row" id="m-ich-o-bi-row" data-value="bisexuell">
                                <span class="orientierung-label">Bisexuell</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="ich" data-type="bisexuell">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="ich" data-type="bisexuell">Sekund√§r</button>
                                </div>
                            </div>
                            <div class="orientierung-option-row" id="m-ich-o-pan-row" data-value="pansexuell">
                                <span class="orientierung-label">Pansexuell</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="ich" data-type="pansexuell">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="ich" data-type="pansexuell">Sekund√§r</button>
                                </div>
                            </div>
                            <div class="orientierung-option-row" id="m-ich-o-queer-row" data-value="queer">
                                <span class="orientierung-label">Queer</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="ich" data-type="queer">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="ich" data-type="queer">Sekund√§r</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- GFK-Kompetenz Grid f√ºr ICH (Mobile) -->
                    <div class="compact-dimension collapsible-dimension" data-dimension="mobile-ich-gfk">
                        <div class="compact-dimension-label"><span class="gfk-info-link">GFK-Kompetenz</span></div>
                        <div class="collapsed-summary" id="mobile-ich-gfk-summary"></div>
                        <div class="gfk-grid" id="mobile-ich-gfk-grid" data-person="ich"></div>
                    </div>
                </div>
            </div>

            <button class="btn-primary-mobile" data-action="mobile-go-to-page" data-page="2">Weiter ‚Üí</button>

            <!-- Reset Button -->
            <button data-action="reset-all" style="width: 100%; padding: 14px; margin-top: 12px; background: transparent; border: 1px solid rgba(255,255,255,0.3); border-radius: 12px; color: rgba(255,255,255,0.7); font-size: var(--font-base); cursor: pointer; transition: all 0.2s;">
                üîÑ Auswahl zur√ºcksetzen
            </button>
        </div>

        <!-- PAGE 2: Best Match Karte (NEU) -->
        <div class="mobile-page" id="mobilePage2" data-page="2" data-page-label="Seite 2: BEST MATCH">
            <div class="page-header">
                <button class="btn-back" data-action="mobile-go-to-page" data-page="1">‚Üê</button>
                <span class="page-title">Partner finden</span>
            </div>

            <!-- Best Match Card -->
            <div style="background: var(--bg-card); border-radius: 16px; border: 1px solid var(--border); border-top: 3px solid #F4A261; padding: 20px; margin-bottom: 15px;">
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="color: #F4A261; font-weight: 700; font-size: var(--font-lg); margin-bottom: 8px;">
                        üé∞ Best Match Finder
                    </div>
                    <div style="color: var(--text-secondary); font-size: var(--font-sm);">
                        Finde den besten Partner basierend auf deinem Profil
                    </div>
                </div>

                <button class="best-match-btn mobile-best-match-card-btn" data-action="open-slot-machine-modal" title="Finde den besten Partner - testet alle 864 Kombinationen" style="width: 100%; padding: 20px; min-height: 80px;">
                    <span class="match-icon" style="font-size: 32px;">üé∞</span>
                    <span class="match-text" style="font-size: 14px;">FINDE PASSENDEN PARTNER</span>
                </button>

                <div style="text-align: center; margin-top: 15px; color: var(--text-muted); font-size: 11px;">
                    Testet alle 864 Archetyp-Kombinationen
                </div>
            </div>

            <button class="btn-primary-mobile" data-action="mobile-go-to-page" data-page="3">Weiter zum Partner ‚Üí</button>

            <button class="btn-secondary-mobile" data-action="mobile-go-to-page" data-page="3" style="width: 100%; padding: 14px; margin-top: 12px; background: transparent; border: 1px solid rgba(255,255,255,0.3); border-radius: 12px; color: rgba(255,255,255,0.7); font-size: var(--font-base); cursor: pointer; transition: all 0.2s;">
                Partner manuell ausw√§hlen ‚Üí
            </button>
        </div>

        <!-- PAGE 3: Partner-Auswahl (vorher PAGE 2) -->
        <div class="mobile-page" id="mobilePage3" data-page="3" data-page-label="Seite 3: PARTNER">
            <div class="page-header">
                <button class="btn-back" data-action="mobile-go-to-page" data-page="2">‚Üê</button>
                <span class="page-title">Dein Partner</span>
            </div>

            <!-- PARTNER Auswahl -->
            <div style="background: var(--bg-card); border-radius: 16px; border: 1px solid var(--border); border-top: 3px solid var(--danger); padding: 15px; margin-bottom: 15px;">
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; color: var(--danger); font-weight: 700; font-size: var(--font-lg);">
                    <span>üë•</span> DEIN PARTNER <span id="mobile-partner-profile-status" class="profile-status-badge"></span>
                </div>
                <div style="display: flex; gap: 8px; align-items: center; margin-bottom: 12px;">
                    <button class="archetype-nav-btn" data-action="navigate-archetype" data-person="partner" data-direction="-1" title="Vorheriger Archetyp">&#9664;</button>
                    <select class="column-select" id="mobilePartnerSelect">
                        <option value="single" title="Bewusste Entscheidung f√ºr ein autonomes Leben ohne Prim√§rbeziehung">Single</option>
                        <option value="duo" selected title="Traditionelle monogame Zweierbeziehung mit Exklusivit√§t">Duo</option>
                        <option value="duo_flex" title="Prim√§re Zweierbeziehung mit vereinbarten √ñffnungen">Duo-Flex</option>
                        <option value="solopoly" title="Mehrere gleichwertige Beziehungen bei Bewahrung der Autonomie">Solopoly</option>
                        <option value="polyamor" title="Mehrere gleichzeitige, ethisch gef√ºhrte Liebesbeziehungen">Polyamor</option>
                        <option value="ra" title="RA - Ablehnung aller Beziehungs-Hierarchien und Labels">RA</option>
                        <option value="lat" title="Living Apart Together - Feste Partnerschaft ohne Zusammenleben">LAT</option>
                        <option value="aromantisch" title="Fokus auf platonische Verbindungen ohne romantische Komponente">Aromantisch</option>
                    </select>
                    <button class="archetype-nav-btn" data-action="navigate-archetype" data-person="partner" data-direction="1" title="N√§chster Archetyp">&#9654;</button>
                    <button data-action="open-archetype-info" data-person="partner" data-select-id="mobilePartnerSelect" style="padding: 12px 16px; background: rgba(255,255,255,0.1); border: 1px solid var(--border); border-radius: 8px; color: var(--text-secondary); cursor: pointer; font-size: 14px; font-weight: 600; letter-spacing: 0.5px;" title="Info zum Archetyp">INFO</button>
                </div>
                <!-- Archetypen-Symbol-Grid f√ºr PARTNER (Mobile) -->
                <div class="archetype-symbols-grid" id="mobile-partner-archetype-grid">
                    <div class="archetype-symbol-item" data-archetype="single" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚òÖ</span>
                        <span class="archetype-symbol-name">Single</span>
                    </div>
                    <div class="archetype-symbol-item active" data-archetype="duo" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚ô°</span>
                        <span class="archetype-symbol-name">Duo</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="duo_flex" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚ö°</span>
                        <span class="archetype-symbol-name">Duo-Flex</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="solopoly" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚óÜ</span>
                        <span class="archetype-symbol-name">Solopoly</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="polyamor" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚ô•</span>
                        <span class="archetype-symbol-name">Polyamor</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="ra" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚àû</span>
                        <span class="archetype-symbol-name">RA</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="lat" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚åÇ</span>
                        <span class="archetype-symbol-name">LAT</span>
                    </div>
                    <div class="archetype-symbol-item" data-archetype="aromantisch" data-action="select-archetype" data-person="partner">
                        <span class="archetype-symbol-icon">‚óá</span>
                        <span class="archetype-symbol-name">Aromantisch</span>
                    </div>
                </div>
                <div class="mobile-header-info-container">
                    <div class="header-geschlecht-info" id="mobile-partner-header-geschlecht"></div>
                    <div class="header-geschlecht-info" id="mobile-partner-header-dominanz"></div>
                    <div class="header-geschlecht-info" id="mobile-partner-header-orientierung"></div>
                </div>
                <!-- FREE Button - Reset Partner GOD (Mobile) -->
                <div style="display: flex; justify-content: center; margin: 8px 0;">
                    <button type="button" data-action="reset-partner-god" class="free-reset-btn" style="padding: 6px 16px; background: linear-gradient(135deg, #f59e0b, #eab308); border: 2px solid #ca8a04; border-radius: 6px; color: #1a1a2e; font-weight: 700; font-size: 12px; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; transition: all 0.2s; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);" title="Partner GOD (Geschlecht, Orientierung, Dominanz) zur√ºcksetzen">FREE</button>
                </div>
                <div class="column-dimensions" id="mobilePartnerDimensions">
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="mobile-partner-geschlecht-multi">
                        <div class="compact-dimension-label"><span class="geschlecht-info-link">Geschlechtsidentit√§t</span> <span id="mobile-partner-geschlecht-legend" class="geschlecht-legend" style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-body-soul-modal"></span></div>
                        <div class="collapsed-summary" id="mobile-partner-geschlecht-summary"></div>
                        <div class="geschlecht-primary-row">
                            <div class="geschlecht-grid geschlecht-p-grid" id="mobile-partner-geschlecht-p-grid" data-person="partner"></div>
                        </div>
                        <div class="geschlecht-secondary-row" id="mobile-partner-geschlecht-s-row" style="display: none;">
                            <div class="geschlecht-grid geschlecht-s-grid" id="mobile-partner-geschlecht-s-grid" data-person="partner"></div>
                        </div>
                        <div class="geschlecht-extras-row">
                            <div class="geschlecht-grid geschlecht-extras-grid" id="mobile-partner-geschlecht-extras-grid" data-person="partner"></div>
                        </div>
                    </div>
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="mobile-partner-dominanz-multi">
                        <div class="compact-dimension-label" data-action="toggle-dimension-collapse">
                            <span><span class="dominanz-info-link" data-stop-propagation>Dominanz</span> <span style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip-stop" data-tooltip-key="dominanzStatus">(P=Prim√§r, S=Sekund√§r)</span></span>
                            <span class="collapse-toggle">‚ñº</span>
                        </div>
                        <div class="collapsed-summary" id="mobile-partner-dominanz-summary"></div>
                        <div class="dominanz-multi-select">
                            <div class="dominanz-option-row" id="m-partner-d-dom-row">
                                <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="dominant" style="cursor: pointer;">dominant</span>
                                <div id="m-partner-d-dom-status" class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="partner" data-type="dominant">Gelebt</button>
                                    <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="partner" data-type="dominant">Interessiert</button>
                                </div>
                            </div>
                            <div class="dominanz-option-row" id="m-partner-d-sub-row">
                                <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="submissiv" style="cursor: pointer;">submissiv</span>
                                <div id="m-partner-d-sub-status" class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="partner" data-type="submissiv">Gelebt</button>
                                    <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="partner" data-type="submissiv">Interessiert</button>
                                </div>
                            </div>
                            <div class="dominanz-option-row" id="m-partner-d-sw-row">
                                <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="switch" style="cursor: pointer;">switch</span>
                                <div id="m-partner-d-sw-status" class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="partner" data-type="switch">Gelebt</button>
                                    <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="partner" data-type="switch">Interessiert</button>
                                </div>
                            </div>
                            <div class="dominanz-option-row" id="m-partner-d-aus-row">
                                <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="ausgeglichen" style="cursor: pointer;">ausgeglichen</span>
                                <div id="m-partner-d-aus-status" class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="partner" data-type="ausgeglichen">Gelebt</button>
                                    <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="partner" data-type="ausgeglichen">Interessiert</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="compact-dimension needs-selection collapsible-dimension" data-dimension="mobile-partner-orientierung-multi">
                        <div class="compact-dimension-label" data-action="toggle-dimension-collapse">
                            <span><span class="orientierung-info-link" data-stop-propagation>Orientierung</span> <span style="font-size: 10px;">(Mehrfachauswahl)</span></span>
                            <span class="collapse-toggle">‚ñº</span>
                        </div>
                        <div class="collapsed-summary" id="mobile-partner-orientierung-summary"></div>
                        <div class="orientierung-multi-select" id="mobile-partner-orientierung-grid" data-person="partner">
                            <div class="orientierung-option-row" id="m-partner-o-hetero-row" data-value="heterosexuell">
                                <span class="orientierung-label">Hetero</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="partner" data-type="heterosexuell">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="partner" data-type="heterosexuell">Sekund√§r</button>
                                </div>
                            </div>
                            <div class="orientierung-option-row" id="m-partner-o-gay-row" data-value="gay_lesbisch">
                                <span class="orientierung-label">Gay/Lesbisch</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="partner" data-type="gay_lesbisch">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="partner" data-type="gay_lesbisch">Sekund√§r</button>
                                </div>
                            </div>
                            <div class="orientierung-option-row" id="m-partner-o-bi-row" data-value="bisexuell">
                                <span class="orientierung-label">Bisexuell</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="partner" data-type="bisexuell">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="partner" data-type="bisexuell">Sekund√§r</button>
                                </div>
                            </div>
                            <div class="orientierung-option-row" id="m-partner-o-pan-row" data-value="pansexuell">
                                <span class="orientierung-label">Pansexuell</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="partner" data-type="pansexuell">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="partner" data-type="pansexuell">Sekund√§r</button>
                                </div>
                            </div>
                            <div class="orientierung-option-row" id="m-partner-o-queer-row" data-value="queer">
                                <span class="orientierung-label">Queer</span>
                                <div class="status-toggle-group">
                                    <button type="button" class="status-toggle-btn" data-status="primaer" data-action="orientierung-status-toggle" data-person="partner" data-type="queer">Prim√§r</button>
                                    <button type="button" class="status-toggle-btn" data-status="sekundaer" data-action="orientierung-status-toggle" data-person="partner" data-type="queer">Sekund√§r</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- GFK-Kompetenz Grid f√ºr PARTNER (Mobile) -->
                    <div class="compact-dimension collapsible-dimension" data-dimension="mobile-partner-gfk">
                        <div class="compact-dimension-label"><span class="gfk-info-link">GFK-Kompetenz</span></div>
                        <div class="collapsed-summary" id="mobile-partner-gfk-summary"></div>
                        <div class="gfk-grid" id="mobile-partner-gfk-grid" data-person="partner"></div>
                    </div>
                </div>
            </div>

            <button class="btn-primary-mobile" data-action="mobile-go-to-page" data-page="4">Analysieren ‚Üí</button>
        </div>

        <!-- PAGE 4: Ergebnis/Synthese (vorher PAGE 3) -->
        <div class="mobile-page" id="mobilePage4" data-page="4" data-page-label="Seite 4: ERGEBNIS">
            <div class="page-header">
                <button class="btn-back" data-action="mobile-go-to-page" data-page="3">‚Üê</button>
                <span class="page-title">Synthese</span>
            </div>

            <div class="types-display" style="flex-direction: column; gap: 8px;">
                <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                    <span style="font-size: 11px; color: var(--text-muted); min-width: 35px;">DU:</span>
                    <button class="archetype-nav-btn" data-action="navigate-archetype-page2" data-person="ich" data-direction="-1" title="Vorheriger">&#9664;</button>
                    <span class="type-name" id="mobileResultIch" style="min-width: 80px; text-align: center;">Single</span>
                    <button class="archetype-nav-btn" data-action="navigate-archetype-page2" data-person="ich" data-direction="1" title="N√§chster">&#9654;</button>
                </div>
                <span style="font-size: 14px; color: var(--text-muted);">√ó</span>
                <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                    <span style="font-size: 11px; color: var(--text-muted); min-width: 35px;">Partner:</span>
                    <button class="archetype-nav-btn" data-action="navigate-archetype-page2" data-person="partner" data-direction="-1" title="Vorheriger">&#9664;</button>
                    <span class="type-name" id="mobileResultPartner" style="min-width: 80px; text-align: center;">Duo</span>
                    <button class="archetype-nav-btn" data-action="navigate-archetype-page2" data-person="partner" data-direction="1" title="N√§chster">&#9654;</button>
                </div>
            </div>

            <div class="score-circle-container">
                <!-- Score Label -->
                <div class="score-label">SCORE</div>
                <!-- Mobile Score Circle -->
                <div class="score-circle-display mobile-score-circle-display" id="mobileScoreCircleDisplay" title="Ti-Age Synthese Score">
                    <svg viewBox="0 0 100 100">
                        <circle class="score-bg" cx="50" cy="50" r="42"></circle>
                        <circle class="score-progress" id="mobileScoreProgress" cx="50" cy="50" r="42" stroke-dasharray="264" stroke-dashoffset="264"></circle>
                    </svg>
                    <div class="score-circle-value" id="mobileScoreCircle">0</div>
                </div>
                <!-- Mobile Lightbulb Button -->
                <div class="lightbulb-button mobile-lightbulb-button" data-action="open-tiage-synthese" title="Ti-Age Synthese √∂ffnen">
                    <span class="lightbulb-icon">üí°</span>
                    <span class="lightbulb-text">Ti-Age Synthese</span>
                </div>
                <!-- Synthese-Text wurde in das CREATIVITY-Modal verschoben -->
                <div id="mobileScoreNote" class="score-note" style="display: none;"></div>
                <!-- KO-Text Display (Mobile) - zeigt KO-Kriterien an -->
                <div id="mobileKoTextDisplay" class="mobile-ko-text-display" style="display: none;"></div>
            </div>

            <!-- GFK Bed√ºrfnis-Matching Anzeige (Mobile) -->
            <div id="mobile-gfk-beduerfnis-display" class="gfk-beduerfnis-display" style="display: none;">
                <!-- Wird dynamisch durch updateGfkBeduerfnisDisplay() gef√ºllt -->
            </div>
        </div>

        <!-- MOBILE: Gewichtung Section (am Ende, nach Synthese) -->
        <div class="mobile-settings-section" id="mobileSettingsSection">
            <div style="background: var(--bg-card); border-radius: 16px; border: 1px solid var(--border); border-top: 3px solid #F59E0B; padding: 15px; margin: 15px 0;">
                <div class="mobile-gewichtung-heading" style="text-align: center; margin-bottom: 12px;">
                    <div style="color: #F59E0B; font-size: 16px; font-weight: 600;">Gewichtung</div>
                    <div style="color: var(--text-muted); font-size: 11px;">0 = Egal ¬∑ 1 = Normal ¬∑ 2 = Wichtig</div>
                </div>
                <!-- AGOD Gewichtung 3-Wege-Schalter f√ºr Mobile -->
                <div class="mobile-gewichtung-container" id="mobileGewichtungContainer">
                    <div class="mobile-gewichtung-row" data-factor="A">
                        <span class="mobile-gewichtung-label">Archetyp</span>
                        <div class="agod-toggle-group mobile" id="mobileToggleA">
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="A" data-value="0">0</button>
                            <button type="button" class="agod-toggle-btn active" data-action="set-agod-weight" data-dimension="A" data-value="1">1</button>
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="A" data-value="2">2</button>
                        </div>
                    </div>
                    <div class="mobile-gewichtung-row" data-factor="G">
                        <span class="mobile-gewichtung-label">Geschlecht</span>
                        <div class="agod-toggle-group mobile" id="mobileToggleG">
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="G" data-value="0">0</button>
                            <button type="button" class="agod-toggle-btn active" data-action="set-agod-weight" data-dimension="G" data-value="1">1</button>
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="G" data-value="2">2</button>
                        </div>
                    </div>
                    <div class="mobile-gewichtung-row" data-factor="O">
                        <span class="mobile-gewichtung-label">Orientierung</span>
                        <div class="agod-toggle-group mobile" id="mobileToggleO">
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="O" data-value="0">0</button>
                            <button type="button" class="agod-toggle-btn active" data-action="set-agod-weight" data-dimension="O" data-value="1">1</button>
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="O" data-value="2">2</button>
                        </div>
                    </div>
                    <div class="mobile-gewichtung-row" data-factor="D">
                        <span class="mobile-gewichtung-label">Dominanz</span>
                        <div class="agod-toggle-group mobile" id="mobileToggleD">
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="D" data-value="0">0</button>
                            <button type="button" class="agod-toggle-btn active" data-action="set-agod-weight" data-dimension="D" data-value="1">1</button>
                            <button type="button" class="agod-toggle-btn" data-action="set-agod-weight" data-dimension="D" data-value="2">2</button>
                        </div>
                    </div>
                </div>
                <div class="mobile-gewichtung-footer" style="display: flex; justify-content: center; align-items: center; margin-top: 12px; padding-top: 10px; border-top: 1px solid var(--border);">
                    <button type="button" data-action="reset-agod-weights" style="padding: 6px 12px; background: rgba(255,255,255,0.1); border: 1px solid var(--border); border-radius: 6px; color: var(--text-secondary); cursor: pointer; font-size: 11px;">Standard (alle auf 1)</button>
                </div>
            </div>
        </div>

        <!-- Page Indicator (4 Seiten: DU, Best Match, Partner, Synthese) -->
        <div class="page-indicator">
            <span class="page-dot active" data-action="mobile-go-to-page" data-page="1"></span>
            <span class="page-dot" data-action="mobile-go-to-page" data-page="2"></span>
            <span class="page-dot" data-action="mobile-go-to-page" data-page="3"></span>
            <span class="page-dot" data-action="mobile-go-to-page" data-page="4"></span>
        </div>
    </div>

    <!-- OLD Carousel (hidden) -->
    <div class="carousel-container" id="carousel" style="display: none;">
        <!-- CARD 1: MEIN TYP -->
        <div class="card" data-card="0">
            <div class="card-inner">
                <div class="card-header">
                    <span class="card-title">Mein Typ</span>
                </div>
                <div class="card-body">
                    <div class="main-select">
                        <label class="main-select-label">Ich bin...</label>
                        <select id="archetypeSelect">
                            <option value="single" title="Bewusste Entscheidung f√ºr ein autonomes Leben ohne Prim√§rbeziehung">Single</option>
                            <option value="duo" title="Traditionelle monogame Zweierbeziehung mit Exklusivit√§t">Duo</option>
                            <option value="duo_flex" title="Prim√§re Zweierbeziehung mit vereinbarten √ñffnungen">Duo-Flex</option>
                            <option value="solopoly" title="Mehrere gleichwertige Beziehungen bei Bewahrung der Autonomie">Solopoly</option>
                            <option value="polyamor" title="Mehrere gleichzeitige, ethisch gef√ºhrte Liebesbeziehungen">Polyamor</option>
                            <option value="ra" title="RA - Ablehnung aller Beziehungs-Hierarchien und Labels">RA</option>
                            <option value="lat" title="Living Apart Together - Feste Partnerschaft ohne Zusammenleben">LAT</option>
                            <option value="aromantisch" title="Fokus auf platonische Verbindungen ohne romantische Komponente">Aromantisch</option>
                        </select>
                    </div>

                    <!-- Extended Dimensions: ICH -->
                    <div class="dimensions-section">
                        <div class="dimensions-section-title ich-title">Meine Eigenschaften</div>
                        <div class="dimensions-grid">
                            <!-- Geschlechtsidentit√§t -->
                            <div class="dimension-group needs-selection" data-dimension="ich-geschlecht">
                                <div class="dimension-label">
                                    <span class="geschlecht-info-link">Geschlechtsidentit√§t</span>
                                    <span style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-body-soul-modal"></span>
                                </div>
                                <div class="geschlecht-grid" id="modal-ich-geschlecht-grid" data-person="ich"></div>
                            </div>

                            <!-- Sexuelle Orientierung -->
                            <div class="dimension-group full-width needs-selection" data-dimension="modal-ich-orientierung-multi">
                                <div class="dimension-label">
                                    Sexuelle Orientierung
                                    <span style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip" data-tooltip-key="status">(P=Prim√§r, S=Sekund√§r)</span>
                                </div>
                                <div class="dominanz-multi-select">
                                    <div class="dominanz-option-row" id="modal-ich-o-het-row">
                                        <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="heterosexuell" style="cursor: pointer;">heterosexuell</span>
                                        <div id="modal-ich-o-het-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="orientierung-status-toggle" data-person="ich" data-type="heterosexuell">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="orientierung-status-toggle" data-person="ich" data-type="heterosexuell">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-ich-o-hom-row">
                                        <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="gay_lesbisch" style="cursor: pointer;">Gay/Lesbisch</span>
                                        <div id="modal-ich-o-hom-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="orientierung-status-toggle" data-person="ich" data-type="gay_lesbisch">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="orientierung-status-toggle" data-person="ich" data-type="gay_lesbisch">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-ich-o-bi-row">
                                        <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="bisexuell" style="cursor: pointer;">Bi-/Pan</span>
                                        <div id="modal-ich-o-bi-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="orientierung-status-toggle" data-person="ich" data-type="bisexuell">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="orientierung-status-toggle" data-person="ich" data-type="bisexuell">Interessiert</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Dominanz Multi-Select -->
                            <div class="dimension-group needs-selection" data-dimension="modal-ich-dominanz-multi">
                                <div class="dimension-label">
                                    Dominanz
                                    <span style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip" data-tooltip-key="dominanzStatus">(P=Prim√§r, S=Sekund√§r)</span>
                                </div>
                                <div class="dominanz-multi-select">
                                    <div class="dominanz-option-row" id="modal-ich-d-dom-row">
                                        <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="dominant" style="cursor: pointer;">dominant</span>
                                        <div id="modal-ich-d-dom-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="ich" data-type="dominant">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="ich" data-type="dominant">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-ich-d-sub-row">
                                        <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="submissiv" style="cursor: pointer;">submissiv</span>
                                        <div id="modal-ich-d-sub-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="ich" data-type="submissiv">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="ich" data-type="submissiv">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-ich-d-sw-row">
                                        <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="switch" style="cursor: pointer;">switch</span>
                                        <div id="modal-ich-d-sw-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="ich" data-type="switch">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="ich" data-type="switch">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-ich-d-aus-row">
                                        <span class="dominanz-label" data-action="show-dimension-tooltip" data-tooltip-key="ausgeglichen" style="cursor: pointer;">ausgeglichen</span>
                                        <div id="modal-ich-d-aus-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn" data-status="gelebt" data-action="dominanz-status-toggle" data-person="ich" data-type="ausgeglichen">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="ich" data-type="ausgeglichen">Interessiert</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="my-type-header">
                        <div class="my-type-icon" id="myTypeIcon">‚òÖ</div>
                        <div class="type-tooltip">
                            <div class="my-type-name" id="myTypeName">Single</div>
                            <span class="tooltip-text" id="myTypeTooltip"></span>
                        </div>
                        <span class="type-info-icon" id="myTypeInfoIcon" data-action="open-type-info" title="Was bedeutet dieser Typ?">‚Ñπ</span>
                    </div>
                    <p class="my-type-desc" id="myTypeDesc">...</p>

                    <!-- Collapsible: Pro/Contra -->
                    <div class="collapsible" id="proContraCollapse">
                        <div class="collapsible-header" data-action="toggle-collapsible" data-target="proContraCollapse">
                            <span>Pro & Contra ‚Äì Qualit√§tsfaktoren</span>
                            <span class="collapsible-icon">‚ñº</span>
                        </div>
                        <div class="collapsible-content">
                            <div class="pro-contra-grid">
                                <div class="mini-list">
                                    <div class="mini-list-title pro">‚úì Pro</div>
                                    <ul id="myTypePro"></ul>
                                </div>
                                <div class="mini-list">
                                    <div class="mini-list-title contra">‚úó Contra</div>
                                    <ul id="myTypeContra"></ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Collapsible: Pathos/Logos -->
                    <div class="collapsible" id="pathosLogosCollapse">
                        <div class="collapsible-header" data-action="toggle-collapsible" data-target="pathosLogosCollapse">
                            <span>Pathos & Logos ‚Äì Dynamische Qualit√§t</span>
                            <span class="collapsible-icon">‚ñº</span>
                        </div>
                        <div class="collapsible-content">
                            <div class="pathos-logos-content">
                                <p id="myTypePathos"></p>
                                <p id="myTypeLogos"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Match Section -->
                    <div class="match-section">
                        <div class="match-card top" id="topMatchCard" data-action="open-match-modal" data-match-type="top">
                            <div class="match-info">
                                <div class="match-dot" id="topMatchDot"></div>
                                <div>
                                    <div class="match-label-text">Top Match</div>
                                    <div class="match-name" id="topMatchName">...</div>
                                </div>
                            </div>
                            <div class="match-score excellent" id="topMatchScore">0</div>
                        </div>

                        <div class="match-card challenge" id="challengeCard" data-action="open-match-modal" data-match-type="challenge">
                            <div class="match-info">
                                <div class="match-dot" id="challengeDot"></div>
                                <div>
                                    <div class="match-label-text">Challenge</div>
                                    <div class="match-name" id="challengeName">...</div>
                                </div>
                            </div>
                            <div class="match-score low" id="challengeScore">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CARD 2: BEZIEHUNGSQUALIT√ÑT -->
        <div class="card" data-card="1">
            <div class="card-inner">
                <div class="card-header">
                    <span class="card-title">Beziehungsqualit√§t</span>
                </div>
                <div class="card-body">
                    <!-- Partner Selector -->
                    <div class="partner-selector" id="partnerSelector"></div>

                    <!-- Extended Dimensions: PARTNER -->
                    <div class="dimensions-section" style="margin-top: 0; padding-top: 15px; border-top: none;">
                        <div class="dimensions-section-title partner-title">Partner-Eigenschaften</div>
                        <div class="dimensions-grid">
                            <!-- Geschlecht -->
                            <div class="dimension-group needs-selection" data-dimension="partner-geschlecht">
                                <div class="dimension-label">
                                    <span class="geschlecht-info-link">Geschlechtsidentit√§t</span>
                                    <span style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-body-soul-modal"></span>
                                </div>
                                <div class="geschlecht-grid" id="modal-partner-geschlecht-grid" data-person="partner"></div>
                            </div>

                            <!-- Sexuelle Orientierung -->
                            <div class="dimension-group full-width needs-selection" data-dimension="modal-partner-orientierung-multi">
                                <div class="dimension-label">
                                    Sexuelle Orientierung
                                    <span style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip" data-tooltip-key="status">(P=Prim√§r, S=Sekund√§r)</span>
                                </div>
                                <div class="dominanz-multi-select">
                                    <div class="dominanz-option-row" id="modal-partner-o-het-row">
                                        <input type="checkbox" id="modal-partner-o-het" value="heterosexuell" class="dominanz-checkbox" onchange="handleModalOrientierungMultiChange('partner', 'heterosexuell', this.checked)">
                                        <label for="modal-partner-o-het" class="dominanz-label" data-action="show-dimension-tooltip-prevent" data-tooltip-key="heterosexuell" style="cursor: pointer;">heterosexuell</label>
                                        <button type="button" id="modal-partner-o-het-secondary" class="secondary-interessiert-btn" data-action="orientierung-secondary-interessiert" data-person="partner" data-type="heterosexuell">interessiert</button>
                                        <div id="modal-partner-o-het-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn active-gelebt" data-status="gelebt" data-action="orientierung-status-toggle" data-person="partner" data-type="heterosexuell">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="orientierung-status-toggle" data-person="partner" data-type="heterosexuell">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-partner-o-hom-row">
                                        <input type="checkbox" id="modal-partner-o-hom" value="gay_lesbisch" class="dominanz-checkbox" onchange="handleModalOrientierungMultiChange('partner', 'gay_lesbisch', this.checked)">
                                        <label for="modal-partner-o-hom" class="dominanz-label" data-action="show-dimension-tooltip-prevent" data-tooltip-key="gay_lesbisch" style="cursor: pointer;">Gay/Lesbisch</label>
                                        <button type="button" id="modal-partner-o-hom-secondary" class="secondary-interessiert-btn" data-action="orientierung-secondary-interessiert" data-person="partner" data-type="gay_lesbisch">interessiert</button>
                                        <div id="modal-partner-o-hom-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn active-gelebt" data-status="gelebt" data-action="orientierung-status-toggle" data-person="partner" data-type="gay_lesbisch">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="orientierung-status-toggle" data-person="partner" data-type="gay_lesbisch">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-partner-o-bi-row">
                                        <input type="checkbox" id="modal-partner-o-bi" value="bisexuell" class="dominanz-checkbox" onchange="handleModalOrientierungMultiChange('partner', 'bisexuell', this.checked)">
                                        <label for="modal-partner-o-bi" class="dominanz-label" data-action="show-dimension-tooltip-prevent" data-tooltip-key="bisexuell" style="cursor: pointer;">Bi-/Pan</label>
                                        <button type="button" id="modal-partner-o-bi-secondary" class="secondary-interessiert-btn" data-action="orientierung-secondary-interessiert" data-person="partner" data-type="bisexuell">interessiert</button>
                                        <div id="modal-partner-o-bi-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn active-gelebt" data-status="gelebt" data-action="orientierung-status-toggle" data-person="partner" data-type="bisexuell">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="orientierung-status-toggle" data-person="partner" data-type="bisexuell">Interessiert</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Dominanz Multi-Select -->
                            <div class="dimension-group needs-selection" data-dimension="modal-partner-dominanz-multi">
                                <div class="dimension-label">
                                    Dominanz
                                    <span style="font-size: 10px; text-decoration: underline; cursor: pointer;" data-action="show-dimension-tooltip" data-tooltip-key="dominanzStatus">(P=Prim√§r, S=Sekund√§r)</span>
                                </div>
                                <div class="dominanz-multi-select">
                                    <div class="dominanz-option-row" id="modal-partner-d-dom-row">
                                        <input type="checkbox" id="modal-partner-d-dom" value="dominant" class="dominanz-checkbox" onchange="handleModalDominanzMultiChange('partner', 'dominant', this.checked)">
                                        <label for="modal-partner-d-dom" class="dominanz-label" data-action="show-dimension-tooltip-prevent" data-tooltip-key="dominant" style="cursor: pointer;">dominant</label>
                                        <button type="button" id="modal-partner-d-dom-secondary" class="secondary-interessiert-btn" data-action="secondary-interessiert" data-person="partner" data-type="dominant">interessiert</button>
                                        <div id="modal-partner-d-dom-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn active-gelebt" data-status="gelebt" data-action="dominanz-status-toggle" data-person="partner" data-type="dominant">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="partner" data-type="dominant">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-partner-d-sub-row">
                                        <input type="checkbox" id="modal-partner-d-sub" value="submissiv" class="dominanz-checkbox" onchange="handleModalDominanzMultiChange('partner', 'submissiv', this.checked)">
                                        <label for="modal-partner-d-sub" class="dominanz-label" data-action="show-dimension-tooltip-prevent" data-tooltip-key="submissiv" style="cursor: pointer;">submissiv</label>
                                        <button type="button" id="modal-partner-d-sub-secondary" class="secondary-interessiert-btn" data-action="secondary-interessiert" data-person="partner" data-type="submissiv">interessiert</button>
                                        <div id="modal-partner-d-sub-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn active-gelebt" data-status="gelebt" data-action="dominanz-status-toggle" data-person="partner" data-type="submissiv">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="partner" data-type="submissiv">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-partner-d-sw-row">
                                        <input type="checkbox" id="modal-partner-d-sw" value="switch" class="dominanz-checkbox" onchange="handleModalDominanzMultiChange('partner', 'switch', this.checked)">
                                        <label for="modal-partner-d-sw" class="dominanz-label" data-action="show-dimension-tooltip-prevent" data-tooltip-key="switch" style="cursor: pointer;">switch</label>
                                        <button type="button" id="modal-partner-d-sw-secondary" class="secondary-interessiert-btn" data-action="secondary-interessiert" data-person="partner" data-type="switch">interessiert</button>
                                        <div id="modal-partner-d-sw-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn active-gelebt" data-status="gelebt" data-action="dominanz-status-toggle" data-person="partner" data-type="switch">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="partner" data-type="switch">Interessiert</button>
                                        </div>
                                    </div>
                                    <div class="dominanz-option-row" id="modal-partner-d-aus-row">
                                        <input type="checkbox" id="modal-partner-d-aus" value="ausgeglichen" class="dominanz-checkbox" onchange="handleModalDominanzMultiChange('partner', 'ausgeglichen', this.checked)">
                                        <label for="modal-partner-d-aus" class="dominanz-label" data-action="show-dimension-tooltip-prevent" data-tooltip-key="ausgeglichen" style="cursor: pointer;">ausgeglichen</label>
                                        <button type="button" id="modal-partner-d-aus-secondary" class="secondary-interessiert-btn" data-action="secondary-interessiert" data-person="partner" data-type="ausgeglichen">interessiert</button>
                                        <div id="modal-partner-d-aus-status" class="status-toggle-group">
                                            <button type="button" class="status-toggle-btn active-gelebt" data-status="gelebt" data-action="dominanz-status-toggle" data-person="partner" data-type="ausgeglichen">Gelebt</button>
                                            <button type="button" class="status-toggle-btn" data-status="interessiert" data-action="dominanz-status-toggle" data-person="partner" data-type="ausgeglichen">Interessiert</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Overview Box -->
                    <div class="analysis-overview" id="analysisOverview" data-action="scroll-to-card" data-card="0">
                        <div class="analysis-overview-title">
                            <span>üîç</span> Analysiere:
                        </div>
                        <div class="analysis-overview-content" id="analysisOverviewContent">
                            <span class="type-name">Single</span> <span class="dim-info">(?, ?, ?)</span>
                            <span> √ó </span>
                            <span class="type-name">Duo</span> <span class="dim-info">(?, ?, ?)</span>
                        </div>
                        <span class="analysis-overview-edit">Bearbeiten ‚Üí</span>
                    </div>

                    <!-- PATHOS BLOCKER (K.O. - replaces entire analysis) -->
                    <div class="pathos-blocker" id="pathosBlocker">
                        <div class="pathos-blocker-header">
                            <span class="pathos-blocker-icon">‚õî</span>
                            <span class="pathos-blocker-title">Keine romantische Beziehung m√∂glich</span>
                        </div>
                        <div class="pathos-blocker-reason" id="pathosBlockerReason">
                            Grund: Keine k√∂rperliche Anziehung m√∂glich aufgrund der sexuellen Orientierungen
                        </div>
                        <div class="pathos-blocker-persons">
                            <div class="pathos-blocker-person">
                                <span class="pathos-blocker-person-label">DU:</span>
                                <span id="pathosBlockerPerson1">m√§nnlich, heterosexuell (Gelebt)</span>
                            </div>
                            <div class="pathos-blocker-person">
                                <span class="pathos-blocker-person-label">PARTNER:</span>
                                <span id="pathosBlockerPerson2">m√§nnlich, heterosexuell (Gelebt)</span>
                            </div>
                        </div>
                        <div class="pathos-blocker-divider"></div>
                        <div class="pathos-blocker-explanation">
                            <h4>Pathos vs. Logos</h4>
                            <p>Ohne k√∂rperliche und emotionale Anziehung (Gef√ºhlsebene) kann keine romantische Beziehung entstehen.</p>
                            <p>Im Gegensatz zu philosophischen Differenzen (Verstandsebene), die durch Kommunikation und Lernen √ºberbr√ºckt werden k√∂nnen, ist sexuelle Orientierung (Gef√ºhlsebene) keine Wahl und nicht ver√§nderbar.</p>
                            <p>Das Tiage-Modell analysiert romantische Beziehungen und ist f√ºr diese Konstellation nicht anwendbar.</p>
                        </div>
                        <div class="pathos-blocker-actions">
                            <button class="pathos-blocker-btn pathos-blocker-btn-primary" data-action="scroll-to-card" data-card="0">
                                Angaben korrigieren
                            </button>
                            <button class="pathos-blocker-btn pathos-blocker-btn-secondary" data-action="show-pathos-logos-info">
                                Mehr √ºber Pathos/Logos
                            </button>
                        </div>
                    </div>

                    <!-- LOGOS WARNING (Warning, analysis continues) -->
                    <div class="logos-warning" id="logosWarning" data-action="toggle-logos-warning">
                        <div class="logos-warning-header">
                            <span class="logos-warning-icon">‚ö†Ô∏è</span>
                            <div class="logos-warning-content">
                                <div class="logos-warning-title" id="logosWarningTitle">Verstandsebene-Warnung: Fundamentale philosophische Unterschiede</div>
                                <div class="logos-warning-subtitle" id="logosWarningSubtitle">Beziehungsphilosophie: 25%</div>
                            </div>
                            <span class="logos-warning-toggle">‚ñº</span>
                        </div>
                        <div class="logos-warning-details">
                            <div class="logos-warning-details-inner">
                                <div class="logos-warning-score">
                                    <span class="logos-warning-score-label">Philosophie-Qualit√§t:</span>
                                    <span class="logos-warning-score-value" id="logosWarningScore">25</span>
                                </div>
                                <p class="logos-warning-text" id="logosWarningText">
                                    Eure Grund√ºberzeugungen √ºber Beziehungen sind sehr unterschiedlich. Dies erfordert intensive Kommunikation und Kompromissbereitschaft.
                                </p>
                                <div class="logos-warning-positive">
                                    <span class="logos-warning-positive-icon">‚úì</span>
                                    <span class="logos-warning-positive-text">ABER: K√∂rperliche Anziehung ist vorhanden!</span>
                                </div>
                                <p class="logos-warning-text">Eine Beziehung ist m√∂glich, erfordert aber:</p>
                                <ul class="logos-warning-list">
                                    <li>Intensive Kommunikation</li>
                                    <li>Fundamentale Kompromisse</li>
                                    <li>Gegenseitiges tiefes Verst√§ndnis</li>
                                </ul>
                                <div class="logos-warning-quote">
                                    "Gef√ºhl kann Br√ºcken bauen, wo der Verstand Widerspr√ºche sieht - aber es wird nicht leicht."
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PATHOS UNCERTAIN (Exploration phase warning) -->
                    <div class="pathos-uncertain" id="pathosUncertain">
                        <span class="pathos-uncertain-icon">üîÑ</span>
                        <span class="pathos-uncertain-text" id="pathosUncertainText">
                            Mindestens eine Person ist in der Explorationsphase (Status: "Interessiert"). Die tats√§chliche k√∂rperliche Anziehung ist noch unklar.
                        </span>
                    </div>

                    <!-- DOUBLE WARNING (Both Pathos uncertain + Logos low) -->
                    <div class="double-warning" id="doubleWarning">
                        <div class="double-warning-header">
                            <span>‚ö†Ô∏è</span>
                            <span class="double-warning-title">Doppelte Herausforderung</span>
                        </div>
                        <div class="double-warning-item">
                            <div class="double-warning-item-title">1. Gef√ºhlsebene: Unsichere k√∂rperliche Anziehung</div>
                            <div class="double-warning-item-text" id="doubleWarningPathos">
                                Partner: bisexuell (interessiert) ‚Üí Exploration-Phase
                            </div>
                        </div>
                        <div class="double-warning-item">
                            <div class="double-warning-item-title">2. Verstandsebene: Philosophische Konflikte</div>
                            <div class="double-warning-item-text" id="doubleWarningLogos">
                                Beziehungsphilosophie: 25% ‚Üí DUO vs. POLYAMOR
                            </div>
                        </div>
                        <p class="logos-warning-text" style="margin-top: 10px; font-size: var(--font-xs);">
                            Sowohl k√∂rperliche als auch philosophische Ebene haben Unsicherheiten.
                        </p>
                    </div>

                    <!-- Compatibility Content Wrapper (hidden when pathos blocked) -->
                    <div id="compatibilityContent">

                    <!-- Modifier Summary (shows dimension influences) -->
                    <div class="modifier-summary" id="modifierSummary">
                        <div class="modifier-summary-title">Dimensions-Einfl√ºsse</div>
                        <div id="modifierSummaryContent">
                            <!-- Dynamically filled -->
                        </div>
                    </div>

                    <!-- Radar Chart -->
                    <div class="radar-section">
                        <div class="radar-header">
                            <div>
                                <div class="radar-title">
                                    <span class="type-tooltip"><span id="myTypeNameDisplay">...</span><span class="tooltip-text" id="myTypeTooltipPage3"></span></span>
                                    mit
                                    <span class="type-tooltip"><span id="partnerNameDisplay">...</span><span class="tooltip-text" id="partnerTooltipPage3"></span></span>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div class="radar-score" id="overallScore" style="color: var(--primary);">0</div>
                                <div class="radar-score-label">Gesamt</div>
                            </div>
                        </div>
                        <svg id="radarChart" viewBox="0 0 280 260"></svg>
                    </div>

                    <!-- Category Bars -->
                    <div class="category-section">
                        <div class="section-title-row">
                            <div class="section-title" style="margin-bottom: 0;">Kategorie-Details</div>
                            <div class="info-icon" data-action="open-category-modal">‚Ñπ</div>
                        </div>
                        <div id="categoryBars"></div>
                    </div>

                    <!-- Pro/Contra Analysis -->
                    <div class="analysis-grid">
                        <div class="analysis-section pro">
                            <div class="analysis-title">‚úì Was funktioniert</div>
                            <ul class="analysis-list" id="partnerPro"></ul>
                        </div>
                        <div class="analysis-section contra">
                            <div class="analysis-title">‚úó Herausforderungen</div>
                            <ul class="analysis-list" id="partnerContra"></ul>
                        </div>
                    </div>
                    </div><!-- End compatibilityContent -->
                </div>
            </div>
        </div>

        <!-- CARD 3: LEGENDE -->
        <div class="card" data-card="2">
            <div class="card-inner">
                <div class="card-header">
                    <span class="card-title">Legende</span>
                </div>
                <div class="card-body">
                    <!-- Farbskala -->
                    <div class="legend-section">
                        <div class="legend-title">Bewertungsskala</div>
                        <div class="color-scale">
                            <div class="color-scale-item">
                                <div class="color-scale-bar bar-good"></div>
                                <span class="color-scale-label">Gut</span>
                                <span class="color-scale-range">70-100%</span>
                            </div>
                            <div class="color-scale-item">
                                <div class="color-scale-bar bar-medium"></div>
                                <span class="color-scale-label">Mittel</span>
                                <span class="color-scale-range">50-69%</span>
                            </div>
                            <div class="color-scale-item">
                                <div class="color-scale-bar bar-low"></div>
                                <span class="color-scale-label">Herausfordernd</span>
                                <span class="color-scale-range">&lt;50%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Kategorien -->
                    <div class="legend-section">
                        <div class="legend-title">Bewertungskategorien</div>
                        <div id="legendCategories"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CARD 4: FEEDBACK -->
        <div class="card" data-card="3">
            <div class="card-inner">
                <div class="card-header">
                    <span class="card-title">Feedback</span>
                </div>
                <div class="card-body">
                    <!-- Search -->
                    <div class="feedback-search">
                        <input type="text" id="feedbackSearch" placeholder="üîç Suche nach Name, Titel oder Inhalt..." class="feedback-search-input">
                    </div>

                    <!-- Advanced Filters -->
                    <div class="feedback-advanced-filters">
                        <div class="feedback-filter-row">
                            <label>Kombination:</label>
                            <select id="filterMyType" class="feedback-select">
                                <option value="all">Alle Typen</option>
                            </select>
                            <span class="filter-separator">mit</span>
                            <select id="filterPartnerType" class="feedback-select">
                                <option value="all">Alle Partner</option>
                            </select>
                        </div>
                        <div class="feedback-filter-row">
                            <label>Kategorie:</label>
                            <div class="feedback-category-btns" id="categoryFilterBtns">
                                <button class="cat-filter-btn active" data-cat="all">Alle</button>
                                <button class="cat-filter-btn" data-cat="A" title="Beziehungsphilosophie">A Philosophie</button>
                                <button class="cat-filter-btn" data-cat="B" title="Werte-Alignment">B Werte</button>
                                <button class="cat-filter-btn" data-cat="C" title="N√§he-Distanz">C N√§he</button>
                                <button class="cat-filter-btn" data-cat="D" title="Autonomie">D Autonomie</button>
                                <button class="cat-filter-btn" data-cat="E" title="Kommunikation">E Kommunik.</button>
                                <button class="cat-filter-btn" data-cat="F" title="Soziale Kompatibilit√§t">F Sozial</button>
                                <!-- Hidden for now - can be re-enabled later -->
                                <button class="cat-filter-btn" data-cat="TM" title="Top Match" style="display:none">Top Match</button>
                                <button class="cat-filter-btn" data-cat="CH" title="Challenge" style="display:none">Challenge</button>
                            </div>
                        </div>
                        <div class="feedback-filter-row">
                            <label>Sortieren:</label>
                            <select id="filterSort" class="feedback-select">
                                <option value="newest">Neueste zuerst</option>
                                <option value="oldest">√Ñlteste zuerst</option>
                                <option value="rating">Beste Bewertung</option>
                            </select>
                        </div>
                    </div>

                    <!-- Feedback List -->
                    <div class="feedback-list" id="feedbackList">
                        <div class="feedback-loading">Lade Feedback...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Category Modal -->
    <div class="modal-overlay" id="categoryModal" data-action="close-category-modal">
        <div class="modal" data-stop-propagation>
            <div class="modal-header">
                <button class="archetype-nav-btn" data-action="navigate-category-archetype" data-direction="-1" title="Vorheriger Archetyp">&#8249;</button>
                <span class="modal-title" id="modalTitle">Kategorie-Details</span>
                <button class="archetype-nav-btn" data-action="navigate-category-archetype" data-direction="1" title="N√§chster Archetyp">&#8250;</button>
                <div class="match-modal-toggle" style="display: flex; gap: 4px; margin-left: 8px;">
                    <button class="match-toggle-btn active" id="matchTogglePathos" data-action="toggle-match-modal-view" data-view="pathos" title="Pathos - Emotionale Resonanz">üî•</button>
                    <button class="match-toggle-btn" id="matchToggleLogos" data-action="toggle-match-modal-view" data-view="logos" title="Logos - Rationale Struktur">üß†</button>
                </div>
                <button class="modal-close" data-action="close-category-modal">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <!-- feedbackModal entfernt - commentModal wird verwendet -->

    <!-- Definition Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="modal-overlay" id="definitionModal" data-action="close-definition-modal">
        <div class="modal definition-modal" data-stop-propagation>
            <div class="modal-header">
                <button class="archetype-nav-btn" data-action="navigate-definition-modal" data-direction="-1" title="Vorheriger Archetyp">&#8249;</button>
                <span class="modal-title" id="definitionModalTitle">Typ-Definition</span>
                <button class="archetype-nav-btn" data-action="navigate-definition-modal" data-direction="1" title="N√§chster Archetyp">&#8250;</button>
                <button class="modal-close" data-action="close-definition-modal">&times;</button>
            </div>
            <div class="modal-body" id="definitionModalBody"></div>
        </div>
    </div>

    <!-- Dimension Info Tooltip Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="dimension-tooltip-overlay" id="dimensionTooltipOverlay" data-action="close-dimension-tooltip">
        <div class="dimension-tooltip-content" data-stop-propagation>
            <div class="dimension-tooltip-title" id="dimensionTooltipTitle">Info</div>
            <div class="dimension-tooltip-text" id="dimensionTooltipText">...</div>
            <button class="dimension-tooltip-close" data-action="close-dimension-tooltip">Verstanden</button>
        </div>
    </div>

    <!-- Geschlecht Info Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="dimension-tooltip-overlay" id="geschlechtInfoModal" data-action="close-geschlecht-info-modal">
        <div class="geschlecht-info-modal-content" data-stop-propagation>
            <div class="geschlecht-info-modal-header">
                <div class="dimension-tooltip-title">Geschlecht</div>
                <button class="geschlecht-info-close-btn" data-action="close-geschlecht-info-modal">&times;</button>
            </div>
            <div class="geschlecht-info-scroll-container">
                <div class="geschlecht-info-item" style="background: rgba(69, 123, 157, 0.1); border-radius: 8px; padding: 12px; margin-bottom: 16px;">
                    <div class="geschlecht-info-name" style="color: var(--primary);">Geschlechtsidentit√§t</div>
                    <div class="geschlecht-info-desc">W√§hle dein <strong>Geschlecht</strong> und optional <strong style="color: #8b5cf6;">Extras</strong> f√ºr mehr Details.</div>
                </div>

                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name" style="font-size: 0.9em; color: var(--text-muted);">GESCHLECHT</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Mann</div>
                    <div class="geschlecht-info-desc">Du identifizierst dich als Mann.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Frau</div>
                    <div class="geschlecht-info-desc">Du identifizierst dich als Frau.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Nonbin√§r</div>
                    <div class="geschlecht-info-desc">Du identifizierst dich weder ausschlie√ülich als Mann noch als Frau.</div>
                </div>

                <div class="geschlecht-info-item" style="margin-top: 16px;">
                    <div class="geschlecht-info-name" style="font-size: 1.1em; color: #8b5cf6; font-weight: bold;">EXTRAS (Optional)</div>
                    <div class="geschlecht-info-desc" style="font-style: italic; margin-top: 4px;">Mehrfachauswahl m√∂glich ‚Äì beschreibt deinen Lifestyle.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Fit üí™</div>
                    <div class="geschlecht-info-desc">Sport und k√∂rperliche Fitness sind dir wichtig.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Fucked up üî•</div>
                    <div class="geschlecht-info-desc">Du hast einen unkonventionellen oder intensiven Lebensstil.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Horny üòà</div>
                    <div class="geschlecht-info-desc">Sexualit√§t spielt eine wichtige Rolle in deinem Leben.</div>
                </div>

                <div class="geschlecht-info-item" style="margin-top: 16px; background: rgba(139, 92, 246, 0.1); border-radius: 8px; padding: 12px;">
                    <div class="geschlecht-info-name" style="font-size: 0.9em; color: #8b5cf6;">HINWEIS</div>
                    <div class="geschlecht-info-desc">
                        Das Geschlecht beeinflusst die <strong>Orientierungs-Kompatibilit√§t</strong>.<br>
                        Die Extras sind optional und helfen, Partner mit √§hnlichem Lifestyle zu finden.
                    </div>
                </div>
            </div>
            <button class="dimension-tooltip-close" data-action="close-geschlecht-info-modal">Verstanden</button>
        </div>
    </div>

    <!-- Dominanz Info Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="dimension-tooltip-overlay" id="dominanzInfoModal" data-action="close-dominanz-info-modal">
        <div class="geschlecht-info-modal-content" data-stop-propagation>
            <div class="geschlecht-info-modal-header">
                <div class="dimension-tooltip-title">Dominanz-Pr√§ferenzen</div>
                <button class="geschlecht-info-close-btn" data-action="close-dominanz-info-modal">&times;</button>
            </div>
            <div class="geschlecht-info-scroll-container">
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Dominant</div>
                    <div class="geschlecht-info-desc"><strong>Der F√ºhrende</strong> ‚Äì Du √ºbernimmst gerne F√ºhrung und Verantwortung in Beziehungen. Assertiv, selbstsicher, bestimmend, proaktiv. Direkte Kommunikation, konfrontiert Konflikte aktiv.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Submissiv</div>
                    <div class="geschlecht-info-desc"><strong>Der Folgende</strong> ‚Äì Du l√§sst dich gerne f√ºhren und vertraust auf deinen Partner. Anpassungsf√§hig, empathisch, harmonieorientiert. Indirekte, diplomatische Kommunikation.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Switch</div>
                    <div class="geschlecht-info-desc"><strong>Der Flexible</strong> ‚Äì Du genie√üt beide Rollen je nach Situation und Partner. Wandelbar, vielseitig, experimentierfreudig. Situativ angepasste Kommunikation.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Ausgeglichen</div>
                    <div class="geschlecht-info-desc"><strong>Der Zentrierte</strong> ‚Äì Du bevorzugst eine gleichberechtigte Dynamik ohne feste Rollen. Balanciert, harmonisch, stabil. Ruhige, konstruktive Kommunikation.</div>
                </div>
            </div>
            <button class="dimension-tooltip-close" data-action="close-dominanz-info-modal">Verstanden</button>
        </div>
    </div>

    <!-- Orientierung Info Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="dimension-tooltip-overlay" id="orientierungInfoModal" data-action="close-orientierung-info-modal">
        <div class="geschlecht-info-modal-content" data-stop-propagation>
            <div class="geschlecht-info-modal-header">
                <div class="dimension-tooltip-title">Sexuelle Orientierungen</div>
                <button class="geschlecht-info-close-btn" data-action="close-orientierung-info-modal">&times;</button>
            </div>
            <div class="geschlecht-info-scroll-container">
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Heterosexuell</div>
                    <div class="geschlecht-info-desc"><strong>Anziehung zum anderen Geschlecht</strong> ‚Äì Du f√ºhlst dich romantisch und/oder sexuell zu Menschen des anderen Geschlechts hingezogen.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Homosexuell</div>
                    <div class="geschlecht-info-desc"><strong>Anziehung zum gleichen Geschlecht</strong> ‚Äì Du f√ºhlst dich romantisch und/oder sexuell zu Menschen des gleichen Geschlechts hingezogen.</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name">Bi-/Pansexuell</div>
                    <div class="geschlecht-info-desc"><strong>Anziehung zu mehreren oder allen Geschlechtern</strong> ‚Äì Du f√ºhlst dich romantisch und/oder sexuell zu Menschen verschiedener Geschlechter hingezogen, unabh√§ngig von deren Geschlechtsidentit√§t.</div>
                </div>
            </div>
            <button class="dimension-tooltip-close" data-action="close-orientierung-info-modal">Verstanden</button>
        </div>
    </div>

    <!-- Body & Soul Info Modal (Phase 2: onclick ‚Üí data-action migriert) -->
    <div class="dimension-tooltip-overlay" id="bodySoulModal" data-action="close-body-soul-modal">
        <div class="geschlecht-info-modal-content" data-stop-propagation style="max-width: 400px;">
            <div class="geschlecht-info-modal-header">
                <div class="dimension-tooltip-title">Body & Soul</div>
                <button class="geschlecht-info-close-btn" data-action="close-body-soul-modal">&times;</button>
            </div>
            <div class="geschlecht-info-scroll-container" style="padding: 16px;">
                <div class="geschlecht-info-item" style="margin-bottom: 12px;">
                    <div class="geschlecht-info-name" style="color: var(--primary); font-weight: bold;"><span class="legend-p">B</span> (Body/Biologie)</div>
                    <div class="geschlecht-info-desc">Deine k√∂rperliche Dimension</div>
                </div>
                <div class="geschlecht-info-item">
                    <div class="geschlecht-info-name" style="color: var(--secondary); font-weight: bold;"><span class="legend-s">S</span> (Soul/Identit√§t)</div>
                    <div class="geschlecht-info-desc">Deine seelische/psychologische Dimension</div>
                </div>
            </div>
            <button class="dimension-tooltip-close" data-action="close-body-soul-modal">Verstanden</button>
        </div>
    </div>

    <!-- Navigation Dots with Arrows (hidden - old carousel nav) -->
    <div class="nav-dots" style="display: none;">
        <button class="nav-arrow" data-action="navigate-prev">‚Äπ</button>
        <div class="nav-dot active" data-card="0" data-action="scroll-to-card"></div>
        <div class="nav-dot" data-card="1" data-action="scroll-to-card"></div>
        <div class="nav-dot" data-card="2" data-action="scroll-to-card"></div>
        <div class="nav-dot" data-card="3" data-action="scroll-to-card"></div>
        <button class="nav-arrow" data-action="navigate-next">‚Ä∫</button>
    </div>

    <div class="swipe-hint" style="display: none;">‚Üê Swipe ‚Üí</div>

    <!-- Footer with Documentation Links -->
    <footer class="app-footer" style="text-align: center; padding: 30px 20px; margin-top: 40px; border-top: 1px solid rgba(255,255,255,0.1); font-size: 13px; color: rgba(255,255,255,0.5);">
        <!-- Partner Logos -->
        <div style="margin-bottom: 25px; display: flex; justify-content: center; align-items: center; gap: 30px; flex-wrap: wrap;">
            <a href="https://www.joyclub.de/" target="_blank" rel="noopener" title="JOYclub">
                <img src="//cfnimg.joyclub.de/partner/joyclub_backlink_mitglied_120x120.png" width="100" height="100" alt="Lebe deine Lust!" style="border-radius: 50%;" />
            </a>
            <a href="https://www.dasding.de/" target="_blank" rel="noopener" title="DASDING - SWR">
                <img src="assets/images/DasDingLogos/SWR_DASDING_Logo_V1_2Z_4C_Weiss.png" height="80" alt="DASDING" style="width: auto;" />
            </a>
        </div>

        <!-- Footer Links Grid -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 25px; max-width: 900px; margin: 0 auto 25px auto; text-align: left;">
            <!-- Philosophische Grundlagen -->
            <div>
                <h4 id="footer-philosophy-title" style="color: #fff; font-size: 14px; margin-bottom: 12px; font-weight: 600;" data-i18n="synthesisSection.philosophischeGrundlagen">Philosophische Grundlagen</h4>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="margin: 8px 0;"><a href="docs.html?doc=docs/theory/tiage-synthesis.md" style="color: #e57373; text-decoration: none;">Tiage-Synthese</a> <span style="color: rgba(255,255,255,0.4);">- Das Gesamtkonzept</span></li>
                    <li style="margin: 8px 0;"><a href="docs.html?doc=docs/theory/pirsig.md" style="color: #e57373; text-decoration: none;">Pirsig-Philosophie</a> <span style="color: rgba(255,255,255,0.4);">- Metaphysik der Qualitaet</span></li>
                    <li style="margin: 8px 0;"><a href="docs.html?doc=docs/theory/osho.md" style="color: #e57373; text-decoration: none;">OSHO-Philosophie</a> <span style="color: rgba(255,255,255,0.4);">- Bewusstsein und Beziehung</span></li>
                    <li style="margin: 8px 0;"><a href="docs.html?doc=docs/theory/pathos-logos.md" style="color: #e57373; text-decoration: none;">Pathos/Logos</a> <span style="color: rgba(255,255,255,0.4);">- Die 40:60 Gewichtung</span></li>
                    <li style="margin: 8px 0;"><a href="docs.html?doc=docs/theory/resonance.md" style="color: #e57373; text-decoration: none;">Resonanz-Theorie</a> <span style="color: rgba(255,255,255,0.4);">- Der Meta-Faktor</span></li>
                </ul>
            </div>

            <!-- Rechtliches -->
            <div>
                <h4 id="footer-legal-title" style="color: #fff; font-size: 14px; margin-bottom: 12px; font-weight: 600;" data-i18n="footer.rechtliches">Rechtliches</h4>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="margin: 8px 0;"><a href="datenschutz.html" style="color: #e57373; text-decoration: none;" data-i18n="footer.datenschutz">Datenschutz</a></li>
                    <li style="margin: 8px 0;"><a href="nutzungsbedingungen.html" style="color: #e57373; text-decoration: none;" data-i18n="footer.nutzungsbedingungen">Nutzungsbedingungen</a></li>
                </ul>
            </div>

            <!-- Wissenschaftliche Quellen -->
            <div>
                <h4 style="color: #fff; font-size: 14px; margin-bottom: 12px; font-weight: 600;">Wissenschaftliche Quellen</h4>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="margin: 8px 0;"><a href="docs.html?doc=profiles/research-sources.md" style="color: #e57373; text-decoration: none;">Research Sources</a> <span style="color: rgba(255,255,255,0.4);">- Vollstaendige Quellensammlung</span></li>
                </ul>
            </div>
        </div>

        <!-- Copyright & Version -->
        <div style="padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
            <div style="margin-bottom: 8px;">&copy; 2025 Ti-Age - Alle Rechte vorbehalten</div>
            <div id="footerVersion" style="margin-bottom: 12px; font-size: 11px; opacity: 0.7;"></div>
            <a href="#" style="color: #eab308; text-decoration: none; margin: 0 10px;" data-action="open-impressum-modal">Impressum</a>
            <span style="color: #eab308;">|</span>
            <a href="docs.html?doc=docs/help-guide.md" style="color: #eab308; text-decoration: none; margin: 0 10px;">Hilfe</a>
        </div>
    </footer>

    <!-- Impressum Modal -->
    <div id="impressumModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:10002; justify-content:center; align-items:center;" data-action="close-impressum-modal">
        <div style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border-radius: 16px; padding: 30px; max-width: 400px; width: 90%; text-align: center; border: 1px solid rgba(255,255,255,0.1);" data-stop-propagation>
            <h3 style="margin: 0 0 20px 0; color: #fff; font-size: 20px;">Impressum</h3>
            <p style="margin: 10px 0; color: rgba(255,255,255,0.8); font-size: 14px;"><strong>Betreiber:</strong> Ti-Age</p>
            <p style="margin: 10px 0; color: rgba(255,255,255,0.8); font-size: 14px;"><strong>Projekt:</strong> Tiage_Beziehungsmodel</p>
            <p style="margin: 10px 0; color: rgba(255,255,255,0.8); font-size: 14px;"><strong>Kontakt:</strong> <a href="mailto:nerd@ti-age.de" style="color: #eab308;">nerd@ti-age.de</a></p>
        </div>
    </div>

    <!-- Memory Management Modal -->
    <div class="modal-overlay" id="memoryModal" data-action="close-memory-modal" style="z-index: 2600;">
        <div class="modal memory-modal" data-stop-propagation style="max-width: 500px;">
            <div class="modal-header" style="border-bottom: 2px solid rgba(59, 130, 246, 0.3);">
                <span class="modal-title" style="color: #3B82F6;">Speichermanagement</span>
                <span class="memory-slot-count-badge">Slots: <span id="memorySlotCount">0/4</span></span>
                <button class="modal-close" data-action="close-memory-modal">&times;</button>
            </div>
            <div class="modal-body" style="padding: 16px;">
                <div class="memory-info-box">
                    <p>Speichere deine aktuellen Einstellungen in bis zu 4 Slots.</p>
                    <p><strong>Speichern:</strong> ME + PARTNER werden zusammen gespeichert</p>
                    <p><strong>Laden:</strong> ME oder PARTNER einzeln ladbar</p>
                </div>
                <div class="memory-slots-list" id="memorySlotsList">
                    <!-- Slots werden dynamisch generiert -->
                </div>
            </div>
        </div>
    </div>

    <!-- Memory Detail Modal -->
    <div class="modal-overlay" id="memoryDetailModal" data-action="close-memory-detail-modal" style="z-index: 2700;">
        <div class="modal memory-detail-modal" data-stop-propagation style="max-width: 95%; width: 650px;">
            <div class="modal-header" style="border-bottom: 2px solid rgba(147, 51, 234, 0.3);">
                <span class="modal-title memory-detail-title" style="color: #A855F7;">Slot Details</span>
                <button class="modal-close" data-action="close-memory-detail-modal">&times;</button>
            </div>
            <div class="modal-body memory-detail-body" style="padding: 16px; max-height: 70vh; overflow-y: auto;">
                <div id="memoryDetailContent">
                    <!-- Content wird dynamisch generiert -->
                </div>
            </div>
        </div>
    </div>

    <!-- Memory Management Modal V2 (8 Slots - ICH per Archetyp + 8 Partner) -->
    <div class="modal-overlay" id="memoryModalV2" onclick="closeMemoryModalV2(event)" style="z-index: 2600;">
        <div class="modal memory-modal-v2" onclick="event.stopPropagation()" style="max-width: 95%; width: 850px;">
            <div class="modal-header" style="border-bottom: 2px solid rgba(59, 130, 246, 0.3);">
                <span class="modal-title" style="color: #3B82F6;">üíæ Speichermanagement V2</span>
                <button class="modal-close" onclick="closeMemoryModalV2()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 16px;">
                <div class="memory-info-box">
                    <p><strong>ICH:</strong> Auto-Save pro Archetyp (8 Slots) | <strong>PARTNER:</strong> Manuell speichern/l√∂schen (8 Slots)</p>
                </div>
                <div class="memory-v2-columns">
                    <!-- ICH-Spalte (8 Archetypen, Auto-Save) -->
                    <div class="memory-v2-column memory-ich-column">
                        <div class="memory-column-header">
                            <span class="memory-column-title">üë§ ICH (Auto-Save)</span>
                            <span class="memory-slot-count-badge" id="memoryIchSlotCount">0/8</span>
                        </div>
                        <div class="memory-ich-slots-list" id="memoryIchSlotsList">
                            <!-- Slots werden dynamisch generiert -->
                        </div>
                    </div>
                    <!-- PARTNER-Spalte (8 unabh√§ngige Slots) -->
                    <div class="memory-v2-column memory-partner-column">
                        <div class="memory-column-header">
                            <span class="memory-column-title">üíï PARTNER (Manuell)</span>
                            <span class="memory-slot-count-badge" id="memoryPartnerSlotCount">0/8</span>
                        </div>
                        <div class="memory-partner-slots-list" id="memoryPartnerSlotsList">
                            <!-- Slots werden dynamisch generiert -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- State Management - Single Source of Truth -->
    <script defer src="js/state.js"></script>
    <!-- Configuration - Dimension Types & Rules -->
    <script defer src="js/config.js"></script>
    <!-- Memory Manager -->
    <script defer src="js/memory-manager.js"></script>
    <script defer src="js/memory-manager-v2.js?v=20260207"></script>
    <script defer src="js/markdown-loader.js"></script>

    <script defer src="js/app-i18n.js?v=20260130"></script>

    <!-- Profile UI Components -->
    <script defer src="js/components/TripleButtonGroup.js?v=20260130"></script>
    <script defer src="js/components/ProfileCard.js?v=20260130"></script>
    <script defer src="js/components/GewichtungCard.js?v=20260130"></script>
    <script defer src="js/components/ResonanzCard.js?v=20260130"></script>
    <script defer src="js/components/CategorySection.js?v=20260130"></script>
    <script defer src="js/components/profile-config.js?v=20260130"></script>
    <!-- NEU: Universeller Dimension-Kategorie-Filter -->
    <script defer src="js/components/DimensionKategorieFilter.js"></script>
    <!-- NEU: Resonanz Tree View (f√ºr hierarchische Filter-Darstellung) -->
    <script defer src="js/components/ResonanzTreeView.js"></script>
    <script defer src="js/components/AttributeSummaryCard.js?v=20260131b"></script>
    <script defer src="js/components/BeduerfnisDetailView.js?v=20260131"></script>
    <script defer src="js/components/profile-components.js"></script>
    <script defer src="js/components/PerspektivenModal.js"></script>

    <!-- Philosophy Hints Components -->
    <script defer src="js/components/PhilosophyHint.js"></script>
    <script defer src="js/components/hints/HintState.js"></script>
    <script defer src="js/components/hints/index.js"></script>
    <script defer src="js/components/hints/MomentsToggle.js"></script>

    <!-- Weight Modules -->
    <script defer src="js/weights/agodWeights.js?v=20260202"></script>
    <script defer src="js/weights/rtiPriorities.js?v=20260202"></script>

    <!-- Modifiers -->
    <script defer src="profiles/modifiers/extras/extras-modifier.js?v=20260202"></script>

    <!-- Modal Modules -->
    <script defer src="js/modals/commentModal.js?v=20260202"></script>
    <script defer src="js/modals/factorExplanations.js?v=20260202"></script>

    <!-- Persistence Modules -->
    <script defer src="js/persistence/visitorTracking.js?v=20260202"></script>

    <script defer src="js/app-main.js?v=20260203d"></script>

    <!-- Resonanz Profile Modal Card Update Script -->
    <script>
        /**
         * Aktualisiert die Resonanz-Profil-Karte im Profile Review Modal
         * mit den aktuellen Resonanzfaktoren der Person
         */
        function updateResonanzProfileModalCard() {
            // Pr√ºfe ob ResonanzCard verf√ºgbar ist
            if (typeof ResonanzCard === 'undefined' || typeof ResonanzCard.getValues !== 'function') {
                console.warn('[Resonanz Profile Modal Card] ResonanzCard nicht verf√ºgbar');
                return;
            }

            // Hole aktuelle Person aus dem Kontext
            const person = (typeof ResonanzCard.getCurrentPerson === 'function')
                ? ResonanzCard.getCurrentPerson()
                : 'ich';

            // Hole Resonanzwerte f√ºr die Person
            const values = ResonanzCard.getValues(person);
            if (!values) {
                console.warn('[Resonanz Profile Modal Card] Keine Werte verf√ºgbar');
                return;
            }

            // Aktualisiere die HTML-Elemente
            ['R1', 'R2', 'R3', 'R4'].forEach(key => {
                const valueElement = document.getElementById(`resonanzProfileValue-${key}`);
                if (valueElement && values[key] !== undefined) {
                    const newValue = values[key].toFixed(2);

                    // Nur aktualisieren wenn sich der Wert ge√§ndert hat
                    if (valueElement.textContent !== newValue) {
                        valueElement.textContent = newValue;
                        valueElement.classList.add('updating');
                        setTimeout(() => valueElement.classList.remove('updating'), 350);
                    }
                }
            });

            console.log('[Resonanz Profile Modal Card] Werte aktualisiert f√ºr', person, values);
        }

        // Lausche auf Resonanzfaktoren-√Ñnderungen
        window.addEventListener('resonanzfaktoren-changed', function(event) {
            // Nur aktualisieren wenn Modal sichtbar ist
            const modal = document.getElementById('profileReviewModal');
            if (modal && !modal.classList.contains('hidden') && modal.style.display !== 'none') {
                updateResonanzProfileModalCard();
            }
        });

        // Beobachte wenn das Modal ge√∂ffnet wird
        const profileReviewModal = document.getElementById('profileReviewModal');
        if (profileReviewModal) {
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'attributes' &&
                        (mutation.attributeName === 'style' || mutation.attributeName === 'class')) {
                        // Pr√ºfe ob Modal jetzt sichtbar ist
                        const isVisible = profileReviewModal.style.display !== 'none' &&
                                        !profileReviewModal.classList.contains('hidden');
                        if (isVisible) {
                            // Kurze Verz√∂gerung f√ºr DOM-Updates
                            setTimeout(updateResonanzProfileModalCard, 100);
                        }
                    }
                });
            });

            observer.observe(profileReviewModal, {
                attributes: true,
                attributeFilter: ['style', 'class']
            });
        }

        // Initial-Update wenn DOM geladen ist
        if (document.readyState === 'complete') {
            updateResonanzProfileModalCard();
        } else {
            window.addEventListener('load', updateResonanzProfileModalCard);
        }

        /**
         * √ñffnet die Bed√ºrfnis-Editor Seite
         * @param {string} archetype - Der Archetyp (z.B. 'polyamor', 'duo')
         * @param {string} person - Die Person ('ich' oder 'partner')
         */
        function openNeedsEditorPage(archetype, person) {
            // Speichere aktuelle Auswahl
            localStorage.setItem('tiage_selected_archetype_' + person, archetype);
            localStorage.setItem('tiage_needs_editor_person', person);

            // Navigiere zur Bed√ºrfnis-Editor Seite
            window.location.href = 'needs-editor.html?archetype=' + encodeURIComponent(archetype) + '&person=' + encodeURIComponent(person);
        }

        // Loading Overlay ausblenden wenn App bereit ist
        function hideLoadingOverlay() {
            var overlay = document.getElementById('appLoadingOverlay');
            if (overlay) {
                overlay.classList.add('hidden');
                // Entferne nach Animation
                setTimeout(function() {
                    overlay.remove();
                    // Entferne auch die kritischen Styles
                    var criticalStyles = document.getElementById('critical-loading-styles');
                    if (criticalStyles) criticalStyles.remove();
                }, 300);
            }
        }

        // Warte auf App-Initialisierung oder Timeout
        if (document.readyState === 'complete') {
            // Kurze Verz√∂gerung f√ºr UI-Initialisierung
            setTimeout(hideLoadingOverlay, 100);
        } else {
            window.addEventListener('load', function() {
                // Kurze Verz√∂gerung f√ºr UI-Initialisierung
                setTimeout(hideLoadingOverlay, 100);
            });
        }

        // Fallback: Loader nach 5 Sekunden ausblenden
        setTimeout(hideLoadingOverlay, 5000);

        // Service Worker registrieren f√ºr Offline-Caching
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(function(registration) {
                        console.log('[SW] Registriert:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('[SW] Registrierung fehlgeschlagen:', error);
                    });
            });
        }
    </script>
</body>
</html>
