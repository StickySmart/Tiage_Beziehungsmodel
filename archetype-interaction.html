<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archetypen-Kompatibilität | Dashboard</title>
    <style>
        :root {
            --primary: #457B9D;
            --primary-light: #A8D5E2;
            --bg-dark: #0f0f1a;
            --bg-card: #1a1a2e;
            --bg-hover: #252542;
            --text-primary: #f0f0f0;
            --text-secondary: #a0a0b0;
            --text-muted: #6a6a7a;
            --border: rgba(255,255,255,0.1);
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Theme Colors */
        body.theme-single { --primary: #E63946; --primary-light: #FFB4A2; }
        body.theme-duo { --primary: #E84393; --primary-light: #FDA7DF; }
        body.theme-duo_flex { --primary: #FF6B6B; --primary-light: #FFA5A5; }
        body.theme-solopoly { --primary: #2A9D8F; --primary-light: #A8DADC; }
        body.theme-poly_hedo { --primary: #9B5DE5; --primary-light: #D4A5FF; }
        body.theme-polyamor { --primary: #F4A261; --primary-light: #FFE5B4; }

        /* Header */
        header {
            text-align: center;
            padding: 20px;
            background: linear-gradient(180deg, rgba(69,123,157,0.15) 0%, transparent 100%);
            border-bottom: 1px solid var(--border);
        }

        h1 {
            font-size: 1.5rem;
            font-weight: 300;
            letter-spacing: 2px;
            margin-bottom: 15px;
        }

        /* Main Dropdown */
        .main-select-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .main-select-label {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        .dropdown-wrapper {
            position: relative;
        }

        #archetypeSelect {
            appearance: none;
            background: var(--bg-card);
            border: 2px solid var(--primary);
            color: var(--text-primary);
            padding: 10px 45px 10px 18px;
            font-size: 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #archetypeSelect:hover {
            box-shadow: 0 0 15px rgba(69,123,157,0.3);
        }

        .dropdown-wrapper::after {
            content: '';
            position: absolute;
            right: 18px;
            top: 50%;
            transform: translateY(-50%);
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 6px solid var(--primary);
            pointer-events: none;
        }

        /* Dashboard Layout */
        .dashboard {
            display: grid;
            grid-template-columns: 38% 62%;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
            min-height: calc(100vh - 120px);
        }

        @media (max-width: 900px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }

        /* Left Panel */
        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .panel-card {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .panel-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel-title {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
        }

        .panel-body {
            padding: 20px;
        }

        /* My Type Card */
        .my-type-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .my-type-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: var(--primary);
        }

        .my-type-name {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary);
        }

        .my-type-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        /* Collapsible Sections */
        .collapsible {
            border-top: 1px solid var(--border);
        }

        .collapsible-header {
            padding: 12px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .collapsible-header:hover {
            color: var(--primary);
        }

        .collapsible-icon {
            transition: transform 0.3s ease;
        }

        .collapsible.open .collapsible-icon {
            transform: rotate(180deg);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .collapsible.open .collapsible-content {
            max-height: 500px;
        }

        .pro-contra-mini {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding-bottom: 15px;
        }

        .mini-list {
            font-size: 0.8rem;
        }

        .mini-list-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .mini-list-title.pro { color: var(--success); }
        .mini-list-title.contra { color: var(--danger); }

        .mini-list ul {
            list-style: none;
            color: var(--text-muted);
        }

        .mini-list li {
            padding: 2px 0;
            padding-left: 12px;
            position: relative;
        }

        .mini-list li::before {
            content: '•';
            position: absolute;
            left: 0;
        }

        .pathos-logos-mini {
            font-size: 0.8rem;
            color: var(--text-muted);
            padding-bottom: 10px;
        }

        .pathos-logos-mini p {
            margin-bottom: 8px;
            font-style: italic;
        }

        /* Match Cards */
        .match-card {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .match-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .match-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .match-name {
            font-size: 0.9rem;
        }

        .match-score {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .match-score.excellent { color: #00cec9; }
        .match-score.good { color: #27ae60; }
        .match-score.medium { color: #f39c12; }
        .match-score.low { color: #e74c3c; }

        .match-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        /* Right Panel */
        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Partner Selector - Clickable Buttons */
        .partner-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 15px;
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
        }

        .partner-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            border: 2px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .partner-btn:hover {
            border-color: var(--text-muted);
            background: var(--bg-hover);
        }

        .partner-btn.active {
            border-color: var(--primary);
            background: rgba(69,123,157,0.2);
            color: var(--text-primary);
        }

        .partner-btn .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Radar Chart Container */
        .radar-container {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            padding: 20px;
            flex: 1;
        }

        .radar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .radar-title {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .radar-score {
            font-size: 2rem;
            font-weight: 700;
        }

        .radar-score-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        #radarChart {
            width: 100%;
            max-width: 350px;
            margin: 0 auto;
            display: block;
        }

        /* Detail Matrix */
        .detail-matrix {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            padding: 20px;
        }

        .matrix-title {
            font-size: 0.9rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }

        .category-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .category-label {
            width: 30px;
            font-weight: 700;
            font-size: 0.9rem;
            color: var(--primary);
        }

        .category-bar-wrap {
            flex: 1;
        }

        .category-bar-container {
            height: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            overflow: hidden;
        }

        .category-bar {
            height: 100%;
            border-radius: 10px;
            transition: width 0.6s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
        }

        .category-bar-value {
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
        }

        .category-name {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .bar-excellent { background: linear-gradient(90deg, #00cec9, #0984e3); }
        .bar-good { background: linear-gradient(90deg, #27ae60, #1e8449); }
        .bar-medium { background: linear-gradient(90deg, #f39c12, #d68910); }
        .bar-low { background: linear-gradient(90deg, #e74c3c, #c0392b); }

        /* Pro/Contra for selected partner */
        .partner-analysis {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            padding: 20px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }

        .analysis-section {
            padding: 15px;
            border-radius: 10px;
        }

        .analysis-section.pro {
            background: rgba(46, 204, 113, 0.1);
            border: 1px solid rgba(46, 204, 113, 0.3);
        }

        .analysis-section.contra {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .analysis-title {
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .analysis-section.pro .analysis-title { color: var(--success); }
        .analysis-section.contra .analysis-title { color: var(--danger); }

        .analysis-list {
            list-style: none;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .analysis-list li {
            padding: 4px 0;
            padding-left: 15px;
            position: relative;
        }

        .analysis-list li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 10px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .analysis-section.pro .analysis-list li::before { background: var(--success); }
        .analysis-section.contra .analysis-list li::before { background: var(--danger); }

        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            color: var(--text-muted);
            font-size: 0.85rem;
            border-top: 1px solid var(--border);
        }
    </style>
</head>
<body>
    <header>
        <h1>ARCHETYPEN-KOMPATIBILITÄT</h1>
        <div class="main-select-container">
            <span class="main-select-label">Ich bin...</span>
            <div class="dropdown-wrapper">
                <select id="archetypeSelect">
                    <option value="single">Single</option>
                    <option value="duo">Duo</option>
                    <option value="duo_flex">Duo-Flex</option>
                    <option value="solopoly">Solopoly</option>
                    <option value="poly_hedo">Poly Hedo</option>
                    <option value="polyamor">Polyamor</option>
                </select>
            </div>
        </div>
    </header>

    <div class="dashboard">
        <!-- LEFT PANEL -->
        <div class="left-panel">
            <!-- My Type Card -->
            <div class="panel-card">
                <div class="panel-header">
                    <span class="panel-title">Mein Typ</span>
                </div>
                <div class="panel-body">
                    <div class="my-type-header">
                        <div class="my-type-icon" id="myTypeIcon">★</div>
                        <div class="my-type-name" id="myTypeName">Single</div>
                    </div>
                    <p class="my-type-desc" id="myTypeDesc">...</p>

                    <!-- Collapsible: Pro/Contra -->
                    <div class="collapsible" id="proContraCollapse">
                        <div class="collapsible-header" onclick="toggleCollapsible('proContraCollapse')">
                            <span>Pro & Contra</span>
                            <span class="collapsible-icon">▼</span>
                        </div>
                        <div class="collapsible-content">
                            <div class="pro-contra-mini">
                                <div class="mini-list">
                                    <div class="mini-list-title pro">✓ Pro</div>
                                    <ul id="myTypePro"></ul>
                                </div>
                                <div class="mini-list">
                                    <div class="mini-list-title contra">✗ Contra</div>
                                    <ul id="myTypeContra"></ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Collapsible: Pathos/Logos -->
                    <div class="collapsible" id="pathosLogosCollapse">
                        <div class="collapsible-header" onclick="toggleCollapsible('pathosLogosCollapse')">
                            <span>Pathos & Logos</span>
                            <span class="collapsible-icon">▼</span>
                        </div>
                        <div class="collapsible-content">
                            <div class="pathos-logos-mini">
                                <p id="myTypePathos"></p>
                                <p id="myTypeLogos"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Top Match -->
            <div class="panel-card">
                <div class="panel-header">
                    <span class="panel-title">Top Match</span>
                </div>
                <div class="panel-body" style="padding: 15px;">
                    <div class="match-card" id="topMatch" style="background: rgba(0,206,201,0.1); border: 1px solid rgba(0,206,201,0.3);">
                        <div class="match-info">
                            <div class="match-dot" id="topMatchDot"></div>
                            <span class="match-name" id="topMatchName">...</span>
                        </div>
                        <div style="text-align: right;">
                            <div class="match-score excellent" id="topMatchScore">0%</div>
                            <div class="match-label">Match</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Challenge -->
            <div class="panel-card">
                <div class="panel-header">
                    <span class="panel-title">Challenge</span>
                </div>
                <div class="panel-body" style="padding: 15px;">
                    <div class="match-card" id="challengeMatch" style="background: rgba(231,76,60,0.1); border: 1px solid rgba(231,76,60,0.3);">
                        <div class="match-info">
                            <div class="match-dot" id="challengeDot"></div>
                            <span class="match-name" id="challengeName">...</span>
                        </div>
                        <div style="text-align: right;">
                            <div class="match-score low" id="challengeScore">0%</div>
                            <div class="match-label">Match</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT PANEL -->
        <div class="right-panel">
            <!-- Partner Selector (Clickable Buttons) -->
            <div class="partner-selector" id="partnerSelector"></div>

            <!-- Radar Chart -->
            <div class="radar-container">
                <div class="radar-header">
                    <div>
                        <div class="radar-title">Kompatibilität mit <span id="partnerNameDisplay">...</span></div>
                    </div>
                    <div style="text-align: right;">
                        <div class="radar-score" id="overallScore" style="color: var(--primary);">0%</div>
                        <div class="radar-score-label">Gesamt</div>
                    </div>
                </div>
                <svg id="radarChart" viewBox="0 0 300 280"></svg>
            </div>

            <!-- Detail Matrix -->
            <div class="detail-matrix">
                <div class="matrix-title">Kategorie-Details</div>
                <div id="categoryBars"></div>
            </div>

            <!-- Pro/Contra Analysis -->
            <div class="partner-analysis">
                <div class="analysis-grid">
                    <div class="analysis-section pro">
                        <div class="analysis-title">✓ Was funktioniert</div>
                        <ul class="analysis-list" id="partnerPro"></ul>
                    </div>
                    <div class="analysis-section contra">
                        <div class="analysis-title">✗ Herausforderungen</div>
                        <ul class="analysis-list" id="partnerContra"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        Archetypen-Interaktionsmatrix v5.0 | Dashboard-Layout | 6×6 Matrix
    </footer>

    <script>
        let data = null;
        let currentArchetype = 'single';
        let selectedPartner = 'duo';

        const icons = {
            single: '★',
            duo: '♡',
            duo_flex: '⚡',
            solopoly: '◆',
            poly_hedo: '☀',
            polyamor: '♥'
        };

        const categoryNames = {
            A: 'Beziehungsphilosophie',
            B: 'Werte-Alignment',
            C: 'Nähe-Distanz',
            D: 'Autonomie',
            E: 'Kommunikation',
            F: 'Soziale Kompatibilität'
        };

        async function loadData() {
            try {
                const response = await fetch('archetype-matrix.json');
                data = await response.json();
            } catch (error) {
                console.error('Error loading data:', error);
                data = getFallbackData();
            }
            initApp();
        }

        function getFallbackData() {
            return {
                archetypes: {
                    single: { id: "single", name: "Single", color: "#E63946", shortDescription: "Fokus auf Selbstentwicklung", pro: [], contra: [], pathos: "", logos: "" },
                    duo: { id: "duo", name: "Duo", color: "#E84393", shortDescription: "Klassische monogame Zweierbeziehung", pro: [], contra: [], pathos: "", logos: "" },
                    duo_flex: { id: "duo_flex", name: "Duo-Flex", color: "#FF6B6B", shortDescription: "Primär Zweierbeziehung mit situativer Öffnung", pro: [], contra: [], pathos: "", logos: "" },
                    solopoly: { id: "solopoly", name: "Solopoly", color: "#2A9D8F", shortDescription: "Polyamor mit Autonomie", pro: [], contra: [], pathos: "", logos: "" },
                    poly_hedo: { id: "poly_hedo", name: "Poly Hedo", color: "#9B5DE5", shortDescription: "Lustorientierte Mehrfachbeziehungen", pro: [], contra: [], pathos: "", logos: "" },
                    polyamor: { id: "polyamor", name: "Polyamor", color: "#F4A261", shortDescription: "Strukturierte Mehrfachbeziehungen", pro: [], contra: [], pathos: "", logos: "" }
                },
                categories: {},
                interactions: {},
                aggregatedMatrix: { rows: [], cols: [], values: [] }
            };
        }

        function initApp() {
            document.getElementById('archetypeSelect').addEventListener('change', (e) => {
                currentArchetype = e.target.value;
                updateAll();
            });
            updateAll();
        }

        function updateAll() {
            updateTheme();
            updateMyType();
            updatePartnerSelector();
            updateTopAndChallenge();
            updatePartnerView();
        }

        function updateTheme() {
            document.body.className = `theme-${currentArchetype}`;
        }

        function updateMyType() {
            const arch = data.archetypes[currentArchetype];
            if (!arch) return;

            document.getElementById('myTypeIcon').textContent = icons[currentArchetype];
            document.getElementById('myTypeIcon').style.background = arch.color;
            document.getElementById('myTypeName').textContent = arch.name;
            document.getElementById('myTypeName').style.color = arch.color;
            document.getElementById('myTypeDesc').textContent = arch.shortDescription || '';

            // Pro list
            const proList = document.getElementById('myTypePro');
            proList.innerHTML = (arch.pro || []).slice(0, 3).map(p => `<li>${p}</li>`).join('');

            // Contra list
            const contraList = document.getElementById('myTypeContra');
            contraList.innerHTML = (arch.contra || []).slice(0, 3).map(c => `<li>${c}</li>`).join('');

            // Pathos/Logos
            document.getElementById('myTypePathos').textContent = arch.pathos || '';
            document.getElementById('myTypeLogos').textContent = arch.logos || '';
        }

        function updatePartnerSelector() {
            const container = document.getElementById('partnerSelector');
            const others = Object.values(data.archetypes).filter(a => a.id !== currentArchetype);

            // Set default selected partner
            if (selectedPartner === currentArchetype || !others.find(o => o.id === selectedPartner)) {
                selectedPartner = others[0]?.id || 'duo';
            }

            container.innerHTML = others.map(arch => `
                <button class="partner-btn ${arch.id === selectedPartner ? 'active' : ''}"
                        onclick="selectPartner('${arch.id}')"
                        data-id="${arch.id}">
                    <span class="dot" style="background: ${arch.color}"></span>
                    ${arch.name}
                </button>
            `).join('');
        }

        function selectPartner(partnerId) {
            selectedPartner = partnerId;

            // Update button states
            document.querySelectorAll('.partner-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.id === partnerId);
            });

            updatePartnerView();
        }

        function updateTopAndChallenge() {
            const others = Object.keys(data.archetypes).filter(id => id !== currentArchetype);
            let topMatch = { id: null, score: 0 };
            let challenge = { id: null, score: 100 };

            others.forEach(otherId => {
                const key = `${currentArchetype}_${otherId}`;
                const interaction = data.interactions[key];
                const score = interaction?.overall || 0;

                if (score > topMatch.score) {
                    topMatch = { id: otherId, score };
                }
                if (score < challenge.score) {
                    challenge = { id: otherId, score };
                }
            });

            // Update Top Match
            if (topMatch.id) {
                const arch = data.archetypes[topMatch.id];
                document.getElementById('topMatchDot').style.background = arch.color;
                document.getElementById('topMatchName').textContent = arch.name;
                document.getElementById('topMatchScore').textContent = topMatch.score + '%';
            }

            // Update Challenge
            if (challenge.id) {
                const arch = data.archetypes[challenge.id];
                document.getElementById('challengeDot').style.background = arch.color;
                document.getElementById('challengeName').textContent = arch.name;
                document.getElementById('challengeScore').textContent = challenge.score + '%';
            }
        }

        function updatePartnerView() {
            const partnerArch = data.archetypes[selectedPartner];
            const interactionKey = `${currentArchetype}_${selectedPartner}`;
            const interaction = data.interactions[interactionKey] || {};

            // Update partner name display
            document.getElementById('partnerNameDisplay').textContent = partnerArch?.name || '...';

            // Update overall score
            const score = interaction.overall || 0;
            const scoreEl = document.getElementById('overallScore');
            scoreEl.textContent = score + '%';
            scoreEl.style.color = getScoreColor(score);

            // Update radar chart
            drawRadarChart(interaction.scores || {}, partnerArch?.color || '#457B9D');

            // Update category bars
            updateCategoryBars(interaction.scores || {});

            // Update Pro/Contra
            const proList = document.getElementById('partnerPro');
            proList.innerHTML = (interaction.pro || []).map(p => `<li>${p}</li>`).join('') || '<li>Keine Daten</li>';

            const contraList = document.getElementById('partnerContra');
            contraList.innerHTML = (interaction.contra || []).map(c => `<li>${c}</li>`).join('') || '<li>Keine Daten</li>';
        }

        function drawRadarChart(scores, color) {
            const svg = document.getElementById('radarChart');
            const cx = 150, cy = 130, maxR = 100;
            const categories = ['A', 'B', 'C', 'D', 'E', 'F'];
            const n = categories.length;

            let html = '';

            // Background circles
            for (let r = 20; r <= maxR; r += 20) {
                html += `<circle cx="${cx}" cy="${cy}" r="${r}" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>`;
            }

            // Axis lines and labels
            categories.forEach((cat, i) => {
                const angle = (Math.PI * 2 * i / n) - Math.PI / 2;
                const x = cx + Math.cos(angle) * maxR;
                const y = cy + Math.sin(angle) * maxR;
                const labelX = cx + Math.cos(angle) * (maxR + 20);
                const labelY = cy + Math.sin(angle) * (maxR + 20);

                html += `<line x1="${cx}" y1="${cy}" x2="${x}" y2="${y}" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>`;
                html += `<text x="${labelX}" y="${labelY}" fill="var(--text-muted)" font-size="11" text-anchor="middle" dominant-baseline="middle">${cat}</text>`;
            });

            // Data polygon
            const points = categories.map((cat, i) => {
                const value = scores[cat]?.value || 0;
                const r = (value / 100) * maxR;
                const angle = (Math.PI * 2 * i / n) - Math.PI / 2;
                return `${cx + Math.cos(angle) * r},${cy + Math.sin(angle) * r}`;
            }).join(' ');

            html += `<polygon points="${points}" fill="${color}33" stroke="${color}" stroke-width="2"/>`;

            // Data points
            categories.forEach((cat, i) => {
                const value = scores[cat]?.value || 0;
                const r = (value / 100) * maxR;
                const angle = (Math.PI * 2 * i / n) - Math.PI / 2;
                const x = cx + Math.cos(angle) * r;
                const y = cy + Math.sin(angle) * r;
                html += `<circle cx="${x}" cy="${y}" r="4" fill="${color}"/>`;
            });

            svg.innerHTML = html;
        }

        function updateCategoryBars(scores) {
            const container = document.getElementById('categoryBars');
            const categories = ['A', 'B', 'C', 'D', 'E', 'F'];

            container.innerHTML = categories.map(cat => {
                const value = scores[cat]?.value || 0;
                const barClass = getBarClass(value);
                const name = categoryNames[cat] || cat;

                return `
                    <div class="category-row">
                        <span class="category-label">${cat}</span>
                        <div class="category-bar-wrap">
                            <div class="category-bar-container">
                                <div class="category-bar ${barClass}" style="width: ${value}%">
                                    <span class="category-bar-value">${value}%</span>
                                </div>
                            </div>
                            <div class="category-name">${name}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getScoreColor(score) {
            if (score >= 78) return '#00cec9';
            if (score >= 70) return '#27ae60';
            if (score >= 60) return '#f39c12';
            return '#e74c3c';
        }

        function getBarClass(value) {
            if (value >= 78) return 'bar-excellent';
            if (value >= 70) return 'bar-good';
            if (value >= 60) return 'bar-medium';
            return 'bar-low';
        }

        function toggleCollapsible(id) {
            document.getElementById(id).classList.toggle('open');
        }

        // Initialize
        loadData();
    </script>
</body>
</html>
