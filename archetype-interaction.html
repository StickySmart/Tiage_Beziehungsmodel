<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archetypen-Interaktionsmatrix | Beziehungsmodelle</title>
    <style>
        :root {
            --single: #E63946;
            --single-light: #FFB4A2;
            --solopoly: #2A9D8F;
            --solopoly-light: #A8DADC;
            --tiage: #457B9D;
            --tiage-light: #A8D5E2;
            --polyamor: #F4A261;
            --polyamor-light: #FFE5B4;
            --hedonistic: #9B5DE5;
            --hedonistic-light: #D4A5FF;
            --bg-dark: #1a1a2e;
            --bg-medium: #16213e;
            --bg-light: #0f3460;
            --text-primary: #f0f0f0;
            --text-secondary: #a0a0a0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-medium) 50%, var(--bg-light) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, var(--single), var(--solopoly), var(--tiage), var(--polyamor), var(--hedonistic));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-style: italic;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Navigation Tabs */
        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .tab-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, var(--tiage), var(--hedonistic));
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Archetype Cards */
        .archetypes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .archetype-card {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .archetype-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .archetype-card.single { border-color: var(--single); }
        .archetype-card.solopoly { border-color: var(--solopoly); }
        .archetype-card.tiage { border-color: var(--tiage); }
        .archetype-card.polyamor { border-color: var(--polyamor); }
        .archetype-card.hedonistic { border-color: var(--hedonistic); }

        .archetype-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .archetype-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .archetype-name {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .archetype-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .trait-list {
            margin-top: 15px;
            list-style: none;
        }

        .trait-list li {
            padding: 5px 0;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .trait-list li::before {
            content: "• ";
            color: inherit;
        }

        /* Matrix Heatmap */
        .matrix-container {
            overflow-x: auto;
            padding: 20px 0;
        }

        .matrix-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: fit-content;
        }

        .matrix-table {
            border-collapse: separate;
            border-spacing: 4px;
            margin: 20px auto;
        }

        .matrix-table th,
        .matrix-table td {
            padding: 0;
            text-align: center;
        }

        .matrix-header {
            padding: 10px;
            font-weight: bold;
            font-size: 0.85rem;
            color: var(--text-primary);
            writing-mode: vertical-rl;
            text-orientation: mixed;
            height: 120px;
        }

        .matrix-row-label {
            padding: 10px 15px;
            font-weight: bold;
            font-size: 0.85rem;
            text-align: right;
            white-space: nowrap;
        }

        .matrix-cell {
            width: 90px;
            height: 90px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .matrix-cell:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }

        .matrix-cell::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 50%);
        }

        .cell-value {
            font-size: 1.5rem;
            font-weight: bold;
            z-index: 1;
        }

        .cell-label {
            font-size: 0.7rem;
            opacity: 0.8;
            z-index: 1;
        }

        /* Color scale for compatibility */
        .compat-very-low { background: linear-gradient(135deg, #ff4757, #c0392b); }
        .compat-low { background: linear-gradient(135deg, #ff7f50, #e67e22); }
        .compat-medium { background: linear-gradient(135deg, #feca57, #f39c12); }
        .compat-good { background: linear-gradient(135deg, #5cd859, #27ae60); }
        .compat-excellent { background: linear-gradient(135deg, #00d2d3, #00a8cc); }

        /* Legend */
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }

        .legend-color {
            width: 24px;
            height: 24px;
            border-radius: 6px;
        }

        /* Detail Panel */
        .detail-panel {
            background: rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 30px;
            margin-top: 30px;
            display: none;
            animation: slideUp 0.4s ease;
        }

        .detail-panel.visible {
            display: block;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .detail-title {
            font-size: 1.5rem;
        }

        .detail-overall {
            font-size: 2rem;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 12px;
        }

        .category-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .category-score {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
        }

        .category-name {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .category-bar-container {
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .category-bar {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .category-value {
            font-size: 1.1rem;
            font-weight: bold;
        }

        .category-note {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .detail-dynamic {
            padding: 20px;
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            border-left: 4px solid var(--tiage);
            font-style: italic;
            line-height: 1.6;
        }

        /* Network Graph */
        .network-container {
            background: rgba(0,0,0,0.2);
            border-radius: 16px;
            padding: 20px;
            min-height: 600px;
            position: relative;
        }

        #networkGraph {
            width: 100%;
            height: 600px;
        }

        /* Categories Tab */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }

        .category-card {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 25px;
            border-left: 4px solid;
        }

        .category-card.cat-A { border-color: #ff6b6b; }
        .category-card.cat-B { border-color: #4ecdc4; }
        .category-card.cat-C { border-color: #45b7d1; }
        .category-card.cat-D { border-color: #96ceb4; }
        .category-card.cat-E { border-color: #ffeaa7; }
        .category-card.cat-F { border-color: #dfe6e9; }

        .category-card h3 {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-letter {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .category-card.cat-A .category-letter { background: #ff6b6b; }
        .category-card.cat-B .category-letter { background: #4ecdc4; }
        .category-card.cat-C .category-letter { background: #45b7d1; }
        .category-card.cat-D .category-letter { background: #96ceb4; }
        .category-card.cat-E .category-letter { background: #ffeaa7; color: #333; }
        .category-card.cat-F .category-letter { background: #dfe6e9; color: #333; }

        .sub-dimensions {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .sub-dimensions h4 {
            font-size: 0.9rem;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .sub-dimensions ul {
            list-style: none;
        }

        .sub-dimensions li {
            padding: 5px 0;
            font-size: 0.9rem;
        }

        /* Special Perspective */
        .perspective-box {
            background: linear-gradient(135deg, rgba(69,123,157,0.2), rgba(155,93,229,0.2));
            border: 2px solid;
            border-image: linear-gradient(135deg, var(--tiage), var(--hedonistic)) 1;
            border-radius: 16px;
            padding: 30px;
            margin-top: 30px;
        }

        .perspective-box h2 {
            margin-bottom: 20px;
            background: linear-gradient(90deg, var(--tiage), var(--hedonistic));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hybrid-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .hybrid-grid {
                grid-template-columns: 1fr;
            }
        }

        .hybrid-section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
        }

        .hybrid-section h4 {
            margin-bottom: 15px;
            color: var(--text-secondary);
        }

        .optimal-match {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .match-score {
            font-size: 1.5rem;
            font-weight: bold;
            min-width: 60px;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: var(--text-primary);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        footer a {
            color: var(--tiage);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <header>
        <h1>Archetypen-Interaktionsmatrix</h1>
        <p class="subtitle">Eine Landkarte der Beziehungskompatibilität aus der Tiage-Hedonist Perspektive</p>
    </header>

    <div class="container">
        <div class="tabs">
            <button class="tab-btn active" data-tab="overview">Archetypen</button>
            <button class="tab-btn" data-tab="matrix">Heatmap Matrix</button>
            <button class="tab-btn" data-tab="network">Netzwerk-Graph</button>
            <button class="tab-btn" data-tab="categories">Kategorien A-F</button>
        </div>

        <!-- Archetypen Overview -->
        <div id="overview" class="tab-content active">
            <div class="archetypes-grid" id="archetypesGrid"></div>

            <div class="perspective-box">
                <h2>Perspektive: Tiage-Hedonist Hybrid</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Diese Matrix wurde aus der Perspektive einer Person erstellt, die zwischen Tiage und Hedonistisch-Poly lebt.
                    Sie vereint den Tiefenwunsch des Tiage-Archetyps mit der hedonistischen Genussorientierung.
                </p>

                <div class="hybrid-grid">
                    <div class="hybrid-section">
                        <h4>Herausforderungen</h4>
                        <ul class="trait-list" id="challengesList"></ul>
                    </div>
                    <div class="hybrid-section">
                        <h4>Stärken</h4>
                        <ul class="trait-list" id="strengthsList"></ul>
                    </div>
                </div>

                <h4 style="margin: 25px 0 15px; color: var(--text-secondary);">Optimale Matches</h4>
                <div id="optimalMatches"></div>
            </div>
        </div>

        <!-- Matrix Heatmap -->
        <div id="matrix" class="tab-content">
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color compat-very-low"></div>
                    <span>&lt;55% Schwierig</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color compat-low"></div>
                    <span>55-62% Herausfordernd</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color compat-medium"></div>
                    <span>63-69% Moderat</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color compat-good"></div>
                    <span>70-77% Gut</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color compat-excellent"></div>
                    <span>&gt;77% Excellent</span>
                </div>
            </div>

            <div class="matrix-container">
                <div class="matrix-wrapper">
                    <p style="color: var(--text-secondary); margin-bottom: 15px;">
                        Zeile = Perspektive VON | Spalte = Beziehung ZU
                    </p>
                    <table class="matrix-table" id="matrixTable"></table>
                </div>
            </div>

            <div class="detail-panel" id="detailPanel">
                <button class="close-btn" onclick="closeDetailPanel()">&times;</button>
                <div class="detail-header">
                    <h3 class="detail-title" id="detailTitle"></h3>
                    <div class="detail-overall" id="detailOverall"></div>
                </div>
                <div class="category-scores" id="categoryScores"></div>
                <div class="detail-dynamic" id="detailDynamic"></div>
            </div>
        </div>

        <!-- Network Graph -->
        <div id="network" class="tab-content">
            <div class="network-container">
                <svg id="networkGraph"></svg>
            </div>
            <p style="text-align: center; color: var(--text-secondary); margin-top: 15px;">
                Liniendicke = Kompatibilitätsstärke | Hover über Knoten für Details
            </p>
        </div>

        <!-- Categories -->
        <div id="categories" class="tab-content">
            <div class="categories-grid" id="categoriesGrid"></div>
        </div>
    </div>

    <footer>
        <p>Archetypen-Interaktionsmatrix v1.0 | Teil des <a href="index.html">Tiage Beziehungsmodells</a></p>
        <p style="margin-top: 10px;">Asymmetrische Matrix - Die Perspektive beeinflusst die wahrgenommene Kompatibilität</p>
    </footer>

    <script>
        // Data
        let matrixData = null;

        // Load JSON data
        async function loadData() {
            try {
                const response = await fetch('archetype-matrix.json');
                matrixData = await response.json();
                initializeApp();
            } catch (error) {
                console.error('Error loading data:', error);
                // Fallback: use embedded data if fetch fails
                matrixData = getEmbeddedData();
                initializeApp();
            }
        }

        function getEmbeddedData() {
            // Embedded fallback data
            return {
                archetypes: {
                    single: { id: "single", name: "Single", color: "#E63946", description: "Fokus auf Selbstentwicklung, temporär oder dauerhaft ungebunden.", coreTraits: ["Selbstfokussiert", "Flexibel in Beziehungsvorstellungen", "Explorativ oder bewusst ungebunden"] },
                    solopoly: { id: "solopoly", name: "Solopoly", color: "#2A9D8F", description: "Polyamor lebend mit Betonung auf voller Autonomie.", coreTraits: ["Maximale Autonomie", "Nicht-hierarchisch", "Tiefe Beziehungen ohne Zusammenleben"] },
                    tiage: { id: "tiage", name: "Tiage", color: "#457B9D", description: "Zwischen Monogamie und Polyamorie. Höchste emotionale Tiefe.", coreTraits: ["Maximale Resonanzfähigkeit", "Tiefe vor Breite", "Hohe moralische Reflexion"] },
                    polyamor: { id: "polyamor", name: "Polyamor", color: "#F4A261", description: "Klassisch polyamor mit mehreren romantischen Beziehungen.", coreTraits: ["Mehrere Liebesbeziehungen", "Oft hierarchisch", "Community-orientiert"] },
                    hedonistic_poly: { id: "hedonistic_poly", name: "Hedonistisch-Poly", color: "#9B5DE5", description: "Polyamor mit Fokus auf Genuss und Freiheit.", coreTraits: ["Genuss-orientiert", "Erfahrungs-fokussiert", "Feier der Sinnlichkeit"] }
                },
                aggregatedMatrix: {
                    rows: ["single", "solopoly", "tiage", "polyamor", "hedonistic_poly"],
                    cols: ["single", "solopoly", "tiage", "polyamor", "hedonistic_poly"],
                    values: [[72, 60, 60, 55, 58], [65, 78, 59, 69, 67], [61, 58, 80, 68, 63], [59, 70, 71, 76, 66], [62, 69, 64, 64, 73]]
                }
            };
        }

        function initializeApp() {
            renderArchetypes();
            renderMatrix();
            renderCategories();
            renderNetwork();
            renderPerspective();
            setupTabs();
        }

        // Tab Navigation
        function setupTabs() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(btn.dataset.tab).classList.add('active');

                    if (btn.dataset.tab === 'network') {
                        setTimeout(renderNetwork, 100);
                    }
                });
            });
        }

        // Render Archetypes
        function renderArchetypes() {
            const grid = document.getElementById('archetypesGrid');
            const archetypes = matrixData.archetypes;

            grid.innerHTML = Object.values(archetypes).map(arch => `
                <div class="archetype-card ${arch.id.replace('_', '-')}" style="border-color: ${arch.color}">
                    <div class="archetype-header">
                        <div class="archetype-icon" style="background: ${arch.color}">
                            ${getArchetypeEmoji(arch.id)}
                        </div>
                        <h3 class="archetype-name" style="color: ${arch.color}">${arch.name}</h3>
                    </div>
                    <p class="archetype-desc">${arch.description}</p>
                    <ul class="trait-list">
                        ${arch.coreTraits.map(t => `<li style="color: ${arch.color}">${t}</li>`).join('')}
                    </ul>
                </div>
            `).join('');
        }

        function getArchetypeEmoji(id) {
            const emojis = {
                single: '&#9733;',      // Star
                solopoly: '&#9670;',    // Diamond
                tiage: '&#9829;',       // Heart
                polyamor: '&#9883;',    // Network
                hedonistic_poly: '&#9788;' // Sun
            };
            return emojis[id] || '&#9679;';
        }

        // Render Matrix
        function renderMatrix() {
            const table = document.getElementById('matrixTable');
            const matrix = matrixData.aggregatedMatrix;
            const archetypes = matrixData.archetypes;

            let html = '<tr><th></th>';

            // Headers
            matrix.cols.forEach(col => {
                const arch = archetypes[col];
                html += `<th class="matrix-header" style="color: ${arch.color}">${arch.name}</th>`;
            });
            html += '</tr>';

            // Rows
            matrix.rows.forEach((row, i) => {
                const arch = archetypes[row];
                html += `<tr><td class="matrix-row-label" style="color: ${arch.color}">${arch.name}</td>`;

                matrix.cols.forEach((col, j) => {
                    const value = matrix.values[i][j];
                    const colorClass = getCompatibilityClass(value);
                    const interactionKey = `${row}_${col}`;

                    html += `
                        <td>
                            <div class="matrix-cell ${colorClass}"
                                 data-from="${row}"
                                 data-to="${col}"
                                 onclick="showDetail('${interactionKey}')">
                                <span class="cell-value">${value}%</span>
                                <span class="cell-label">${row === col ? 'SELBST' : ''}</span>
                            </div>
                        </td>
                    `;
                });
                html += '</tr>';
            });

            table.innerHTML = html;
        }

        function getCompatibilityClass(value) {
            if (value < 55) return 'compat-very-low';
            if (value < 63) return 'compat-low';
            if (value < 70) return 'compat-medium';
            if (value < 78) return 'compat-good';
            return 'compat-excellent';
        }

        function getBarColor(value) {
            if (value < 55) return '#ff4757';
            if (value < 63) return '#ff7f50';
            if (value < 70) return '#feca57';
            if (value < 78) return '#5cd859';
            return '#00d2d3';
        }

        // Show Detail Panel
        function showDetail(key) {
            const interaction = matrixData.interactions[key];
            if (!interaction) return;

            const fromArch = matrixData.archetypes[interaction.from];
            const toArch = matrixData.archetypes[interaction.to];

            document.getElementById('detailTitle').innerHTML = `
                <span style="color: ${fromArch.color}">${fromArch.name}</span>
                <span style="color: var(--text-secondary)"> → </span>
                <span style="color: ${toArch.color}">${toArch.name}</span>
            `;

            const overallEl = document.getElementById('detailOverall');
            overallEl.textContent = `${interaction.overall}%`;
            overallEl.className = `detail-overall ${getCompatibilityClass(interaction.overall)}`;

            // Category scores
            const categories = matrixData.categories;
            const scoresHtml = Object.entries(interaction.scores).map(([cat, data]) => `
                <div class="category-score">
                    <div class="category-name">${cat}: ${categories[cat].name}</div>
                    <div class="category-bar-container">
                        <div class="category-bar" style="width: ${data.value}%; background: ${getBarColor(data.value)}"></div>
                    </div>
                    <div class="category-value" style="color: ${getBarColor(data.value)}">${data.value}%</div>
                    <div class="category-note">${data.note}</div>
                </div>
            `).join('');

            document.getElementById('categoryScores').innerHTML = scoresHtml;
            document.getElementById('detailDynamic').textContent = interaction.dynamic;

            const panel = document.getElementById('detailPanel');
            panel.classList.add('visible');
            panel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function closeDetailPanel() {
            document.getElementById('detailPanel').classList.remove('visible');
        }

        // Render Categories
        function renderCategories() {
            const grid = document.getElementById('categoriesGrid');
            const categories = matrixData.categories;

            grid.innerHTML = Object.entries(categories).map(([key, cat]) => `
                <div class="category-card cat-${key}">
                    <h3>
                        <span class="category-letter">${key}</span>
                        ${cat.name}
                    </h3>
                    <p>${cat.description}</p>
                    <div class="sub-dimensions">
                        <h4>Sub-Dimensionen:</h4>
                        <ul>
                            ${cat.subDimensions.map(s => `<li>${s}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `).join('');
        }

        // Render Perspective Section
        function renderPerspective() {
            const perspective = matrixData.specialPerspective;
            if (!perspective) return;

            // Challenges
            document.getElementById('challengesList').innerHTML =
                perspective.hybridProfile.challenges.map(c => `<li>${c}</li>`).join('');

            // Strengths
            document.getElementById('strengthsList').innerHTML =
                perspective.hybridProfile.strengths.map(s => `<li>${s}</li>`).join('');

            // Optimal Matches
            const matchesHtml = perspective.optimalMatches.map(match => {
                const arch = matrixData.archetypes[match.archetype];
                return `
                    <div class="optimal-match">
                        <div class="match-score" style="color: ${arch.color}">${match.compatibility}%</div>
                        <div>
                            <strong style="color: ${arch.color}">${arch.name}</strong>
                            <p style="font-size: 0.9rem; color: var(--text-secondary)">${match.reason}</p>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('optimalMatches').innerHTML = matchesHtml;
        }

        // Render Network Graph
        function renderNetwork() {
            const svg = document.getElementById('networkGraph');
            const container = svg.parentElement;
            const width = container.clientWidth;
            const height = 600;

            svg.setAttribute('width', width);
            svg.setAttribute('height', height);
            svg.innerHTML = '';

            const archetypes = Object.values(matrixData.archetypes);
            const matrix = matrixData.aggregatedMatrix;

            // Position nodes in a pentagon
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) * 0.35;

            const nodes = archetypes.map((arch, i) => {
                const angle = (i * 2 * Math.PI / 5) - Math.PI / 2;
                return {
                    ...arch,
                    x: centerX + radius * Math.cos(angle),
                    y: centerY + radius * Math.sin(angle),
                    index: i
                };
            });

            // Draw edges first (so nodes appear on top)
            const edgesGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');

            for (let i = 0; i < nodes.length; i++) {
                for (let j = i + 1; j < nodes.length; j++) {
                    const valueIJ = matrix.values[i][j];
                    const valueJI = matrix.values[j][i];
                    const avgValue = (valueIJ + valueJI) / 2;

                    const strokeWidth = Math.max(1, (avgValue - 50) / 10);
                    const opacity = 0.3 + (avgValue / 100) * 0.5;

                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', nodes[i].x);
                    line.setAttribute('y1', nodes[i].y);
                    line.setAttribute('x2', nodes[j].x);
                    line.setAttribute('y2', nodes[j].y);
                    line.setAttribute('stroke', getEdgeColor(avgValue));
                    line.setAttribute('stroke-width', strokeWidth);
                    line.setAttribute('opacity', opacity);

                    edgesGroup.appendChild(line);
                }
            }
            svg.appendChild(edgesGroup);

            // Draw nodes
            const nodesGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');

            nodes.forEach(node => {
                // Node circle
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', node.x);
                circle.setAttribute('cy', node.y);
                circle.setAttribute('r', 40);
                circle.setAttribute('fill', node.color);
                circle.setAttribute('stroke', '#fff');
                circle.setAttribute('stroke-width', 2);
                circle.style.cursor = 'pointer';
                circle.style.transition = 'all 0.3s ease';

                circle.addEventListener('mouseenter', () => {
                    circle.setAttribute('r', 48);
                });
                circle.addEventListener('mouseleave', () => {
                    circle.setAttribute('r', 40);
                });

                nodesGroup.appendChild(circle);

                // Node label
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', node.x);
                text.setAttribute('y', node.y + 60);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('fill', '#f0f0f0');
                text.setAttribute('font-size', '14');
                text.setAttribute('font-weight', 'bold');
                text.textContent = node.name;

                nodesGroup.appendChild(text);

                // Icon in circle
                const icon = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                icon.setAttribute('x', node.x);
                icon.setAttribute('y', node.y + 8);
                icon.setAttribute('text-anchor', 'middle');
                icon.setAttribute('fill', '#fff');
                icon.setAttribute('font-size', '24');
                icon.innerHTML = getArchetypeEmoji(node.id);

                nodesGroup.appendChild(icon);
            });

            svg.appendChild(nodesGroup);
        }

        function getEdgeColor(value) {
            if (value < 55) return '#ff4757';
            if (value < 63) return '#ff7f50';
            if (value < 70) return '#feca57';
            if (value < 78) return '#5cd859';
            return '#00d2d3';
        }

        // Initialize
        loadData();
    </script>
</body>
</html>
